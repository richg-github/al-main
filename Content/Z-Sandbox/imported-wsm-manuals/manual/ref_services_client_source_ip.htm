<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation_Skin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta name="zd-site-verification" content="9muqcovj07pyvoduai2al" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="1545x1545" href="../../../../Skins/Favicons/AlertLogic_Logo_2C_RGB_V_Standard.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>1.7.&#160;Client Source IP</title>
        <meta http-equiv="Cache-control" content="no-cache" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <style>@import url('https://richg-github.github.io/al-styles/override-main.css');

</style>
        <link href="../../../Resources/Stylesheets/MainStyles.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.next-topic-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.separator-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.print-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.expand-all-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.collapse-all-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link rel="apple-touch-icon" sizes="1545x1545" href="../../../../Skins/Favicons/AlertLogic_Logo_2C_RGB_V_Standard.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <link rel="home" href="index.htm" title="Administration Manual" />
        <link rel="up" href="ref_services_virtual_host.htm" title="1.&#160;Virtual host" />
        <link rel="prev" href="ref_services_virtual_host_throttling.htm" title="1.6.&#160;HTTP Request and Connection Throttling" />
        <link rel="next" href="ref_services_virtual_host_redirects.htm" title="1.8.&#160;Redirects" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_Toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                        <div class="button-group-container-left">
                                            <button class="button needs-pie previous-topic-button" title="Navigate previous" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate previous">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie next-topic-button" title="Navigate next" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate next">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <div class="button-separator">
                                            </div>
                                            <button class="button needs-pie print-button" title="Print">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Print">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Expand all">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                        </div>
                                    </div>
                                    <div role="main" id="mc-main-content">
                                        <div class="navheader">
                                            <table width="100%" summary="Navigation header">
                                                <tr>
                                                    <th colspan="3" align="center" />
                                                </tr>
                                                <tr>
                                                    <td width="20%" align="left"><a accesskey="p" href="ref_services_virtual_host_throttling.htm">Prev</a>&#160;
               </td>
                                                    <th width="60%" align="center">1.&#160;Virtual host</th>
                                                    <td width="20%" align="right">&#160;<a accesskey="n" href="ref_services_virtual_host_redirects.htm">Next</a></td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div class="sect2" title="1.7.&#160;Client Source IP">
                                            <div class="titlepage">
                                                <div>
                                                    <div>
                                                        <h3 class="title"><a name="ref_services_client_source_ip"></a>1.7.&#160;Client Source IP
                  </h3>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="toc">
                                                <dl>
                                                    <dt><span class="sect3"><a href="#ref_services_client_source_ip_xff">1.7.1. X-Forwarded-For</a></span>
                                                    </dt>
                                                    <dt><span class="sect3"><a href="#d0e3719">1.7.2. Other X-headers</a></span>
                                                    </dt>
                                                    <dt><span class="sect3"><a href="#ref_services_virtual_host_trusted_proxy">1.7.3. Trusted proxy</a></span>
                                                    </dt>
                                                    <dt><span class="sect3"><a href="#ref_services_client_source_ip_transparent_p">1.7.4. Transparent Proxy</a></span>
                                                    </dt>
                                                </dl>
                                            </div>
                                            <p><a name="client_source_ip_intro_general"></a>HTTP requests often pass through one or more proxy servers before reaching the endpoint Web server. Examples include Web gateways
 in the client network, content delivery networks (CDN), caching servers, SSL accelerators, layer 7 load balancers and Web
 application firewalls. Each time the request passes through a proxy server, the source IP of the request is changed to the
 IP address of the proxy server. This means that endpoint Web servers cannot rely on the source IP from the network connection
 (socket) to be the IP address of the original request. To account for this it has become a de-facto standard that proxy servers
 insert the client source IP in a request header named X-Forwarded-For. This is the default behavior of WSM.
         </p>
                                            <p lang="client_source_ip_intro_transparent_proxy">Another option is to configure WSM as a <span class="bold"><strong>Transparent Proxy</strong></span>, which re-inserts the client source IP before forwarding the request to the backend Web environment.
         </p>
                                            <div class="sect3" title="1.7.1.&#160;X-Forwarded-For">
                                                <div class="titlepage">
                                                    <div>
                                                        <div>
                                                            <h4 class="title"><a name="ref_services_client_source_ip_xff"></a>1.7.1.&#160;X-Forwarded-For
                     </h4>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p>De-facto standard for forwarding client source IP from layer 7 proxies. Header is always inserted.</p>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left" />
                                                            <col width="75%" align="left" />
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">X-Forwarded-For</span></b>
                                                                </td>
                                                                <td align="left">
                                                                    <div class="itemizedlist">
                                                                        <ul class="itemizedlist" type="disc">
                                                                            <li class="listitem">
                                                                                <p>Client source IP will be inserted in X-Forwarded-For header</p>
                                                                            </li>
                                                                            <li class="listitem">
                                                                                <p>Client source IP will be present in the header even if the request has passed through other proxy servers</p>
                                                                            </li>
                                                                            <li class="listitem">
                                                                                <p>Standards compliant approach</p>
                                                                            </li>
                                                                            <li class="listitem">
                                                                                <p>Better performance because connections to backend Web servers can be kept alive</p>
                                                                            </li>
                                                                            <li class="listitem">
                                                                                <p>May require modifications to backend applications to read the X-Forwarded-For header</p>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                    <p>The X-Forwarded header is always inserted.</p>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <p>The X-Forwarded-For (XFF) HTTP header field is a de facto standard for identifying the originating IP address of a client
 connecting to a Web server through an HTTP proxy or load balancer. This is an HTTP request header that was introduced by the
 Squid caching proxy server's developers. An effort has been started at IETF for standardizing the Forwarded HTTP header.
            </p>
                                                <p>When the request passes through multiple proxy servers, each server will add the respective source IP to the X-Forwarded-For
 header. The X-Forwarded-For header thus contains a list of IP addresses the request has passed through. The leftmost IP address
 is the original client IP. The rightmost IP address is the last proxy in the chain, and the source IP of the request is the
 address of the last proxy.
            </p>
                                                <p>This allows the endpoint Web server to extract and log the original client IP address from the XFF header for applications
 that need this data rather than the IP address of the last proxy in the chain from which the endpoint Web server received
 the request.
            </p>
                                                <p>As Web Security Manager is a proxy-based device, it terminates requests from clients and makes requests to the backend Webserver
 on behalf of the client. To make the original source IP available to the backend Web application, Web Security Manager forwards
 the source IP address to the backend server in the X- Forwarded-For header.
            </p>
                                            </div>
                                            <div class="sect3" title="1.7.2.&#160;Other X-headers">
                                                <div class="titlepage">
                                                    <div>
                                                        <div>
                                                            <h4 class="title"><a name="d0e3719"></a>1.7.2.&#160;Other X-headers
                     </h4>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p>In addition to the X-Forwarded-For header Layer 7 proxies also often insert X-headers with information about which protocol
 and port the request was received on. These headers are named
            </p>
                                                <div class="variablelist">
                                                    <dl>
                                                        <dt><span class="term">X-Forwarded-Proto</span>
                                                        </dt>
                                                        <dd>
                                                            <p>Contains the protocol the request was received on - HTTP or HTTPS</p>
                                                        </dd>
                                                        <dt><span class="term">X-Forwarded-Port</span>
                                                        </dt>
                                                        <dd>
                                                            <p>Contains the port the request was received on</p>
                                                        </dd>
                                                    </dl>
                                                </div>
                                                <p>Note that contrary to the X-Forwarded-For header these headers are not lists. This means that the information in them will
 be overwritten by WSM if it receives the request from a proxy that has already inserted them.
            </p>
                                                <p>If If requests through WSM passes through further layer 7 proxies on their way to the backend servers, to keep the value of
 these headers as received by WSM intact, it is necessary to copy the value of those headers into reserved custom headers like
 X-WSM-Forwarded-Proto. This can be accomplished by inserting request headers. See <a class="xref" href="ref_services_load_balancing_health_checking.htm" title="2.4.&#160;Health Checking">Section&#160;2.4, “Health Checking”</a> for details.
            </p>
                                            </div>
                                            <div class="sect3" title="1.7.3.&#160;Trusted proxy">
                                                <div class="titlepage">
                                                    <div>
                                                        <div>
                                                            <h4 class="title"><a name="ref_services_virtual_host_trusted_proxy"></a>1.7.3.&#160;Trusted proxy
                     </h4>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p>Since the X-headers are part of the client request WSM receives, and as such can be manipulated by the client, by definition
 they cannot be trusted. However, if the proxy that receives the request from the client, for instance a load balancer in front
 of WSM, follows the standard of appending the source IP it receives the request from to the X-Forwarded-For header along with
 overwriting values in X-Forwarded-Proto and X-Forwarded-Port headers with protocol and port information, the information inserted
 by that proxy <span class="bold"><strong>can</strong></span> be trusted since the client does not control that information. Such a proxies, defined by one or more IPs, are referred to
 as <span class="bold"><strong>Trusted Proxies</strong></span> throughout this manual.
            </p>
                                                <p><span class="emphasis"><em>When WSM receives a request from a trusted proxy it will extract the client source IP from the X-Forwarded-For header and
 use that IP address in place of the actual request (socket) IP for both HTTP Throttling and, if enabled, IP based blocking.
 For the IP based blocking controls the X-Forwarded-For IP will transparently replace the socket IP and the network blocking
 controls will work without other modification to the policy.</em></span>
                                                </p>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left" />
                                                            <col width="75%" align="left" />
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Use trusted proxy - extract client source IP from X-Forwarded-For header</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Enable Trusted Proxy functionality.</p>
                                                                    <p>When enabled, if request is received from a proxy in the list of trusted proxies (see below):</p>
                                                                    <div class="itemizedlist">
                                                                        <ul class="itemizedlist" type="disc">
                                                                            <li class="listitem">
                                                                                <p>WSM will extract the client source IP from the X-Forwarded-For header</p>
                                                                            </li>
                                                                            <li class="listitem">
                                                                                <p>Use the extracted client source IP for HTTP Throttling (when enabled)</p>
                                                                            </li>
                                                                            <li class="listitem">
                                                                                <p>Use the extracted client source IP for IP whitelisting controls</p>
                                                                            </li>
                                                                            <li class="listitem">
                                                                                <p>Transparently enforce the source IP based request blocking at layer 7 based on the extracted IP instead of at the network
 level
                                    </p>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                    <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Reset X-Forwarded-For header to last untrusted source in list</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Following the proposed standard, the X-Forwarded-For header may contain a comma separated list of IP addresses. Depending
 on the configuration options in the endpoint Web server and application, it may be logged as such which may not be desirable.
                           </p>
                                                                    <p>To have WSM always forward the X-Forwarded-For a single IP address, enable this option. </p>
                                                                    <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Forward X-Forwarded-For and X-Forwarded-Proto headers from trusted proxy unaltered</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Leave X-Headers untouched from trusted proxy.</p>
                                                                    <p>If Web Security Manager is deployed behind another reverse proxy, by default, Web Security Manager will insert the source
 IP from that proxy in the X-Forwarded-For header sent to the backend web server. If the X-Forwarded-For header is already
 present the source IP will be appended to the header.
                           </p>
                                                                    <p>While this behaviour conforms to standards it is not always desirable. It is therefore possible to configure trusted proxies
 from which Web Security Manager will simply forwarded the X-Forwarded-For header as it is received from the trusted proxy
 without modifying it.
                           </p>
                                                                    <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel"> List of trusted proxies</span></b>
                                                                    <p>Input field</p>
                                                                </td>
                                                                <td align="left">
                                                                    <p>List of trusted source IPs from which X-Forwarded-For header will be forwarded unmodified to the backend web server.</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>IP addresses with net mask (IP/mask) in CIDR notation separated by newline</p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">192.168.0.8/32</code> - the IP address 192.168.0.8
                                    </p>
                                                                                <p><code class="literal">192.168.0.0/24</code> - IP addresses 192.168.0.0 - 255
                                    </p>
                                                                                <p><code class="literal">192.168.0.8/29</code> - IP addresses 192.168.0.8-15
                                    </p>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">&lt;none&gt;</code>
                                                                                </p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="sect3" title="1.7.4.&#160;Transparent Proxy">
                                                <div class="titlepage">
                                                    <div>
                                                        <div>
                                                            <h4 class="title"><a name="ref_services_client_source_ip_transparent_p"></a>1.7.4.&#160;Transparent Proxy
                     </h4>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p>Play tricks at the network level to inject the client IP as the source of the request to the backend server. Requires modification
 of default gateway at the backend server to make the response go back through WSM.
            </p>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left" />
                                                            <col width="75%" align="left" />
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Transparent Proxy</span></b>
                                                                </td>
                                                                <td align="left">
                                                                    <div class="itemizedlist">
                                                                        <ul class="itemizedlist" type="disc">
                                                                            <li class="listitem">
                                                                                <p>WSM will insert the client source IP as the source IP of the request it forwards to the backend Web server</p>
                                                                            </li>
                                                                            <li class="listitem">
                                                                                <p>Backend Web servers need to be configured to use WSM as the default gateway to ensure inspection of return Web traffic and
 a response to the client request
                                    </p>
                                                                            </li>
                                                                            <li class="listitem">
                                                                                <p>IP-Forwarding (routing) needs to be enabled in WSM</p>
                                                                            </li>
                                                                            <li class="listitem">
                                                                                <p>Performance drawbacks because connections from WSM to backend Web servers cannot be kept alive and because all traffic, including
 non-HTTP, from Web servers have to pass through WSM
                                    </p>
                                                                            </li>
                                                                            <li class="listitem">
                                                                                <p>Because WSM needs to be the default gateway Transparent Proxy is only recommended for smaller deployments where WSM is not
 deployed in combination with a load balancer
                                    </p>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                    <p>Transparent proxy needs to be enabled and configured. See below.</p>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <p>Transparent Proxy is a configuration option that can be applied to both Routing Proxy and Reverse Proxy deployment modes.</p>
                                                <p>When enabled WSM will preserve the client source IP by inserting it in the request to the backend web server. In practice
 it is spoofing the client source IP and for that reason this feature is sometimes also called Client Impersonation.
            </p>
                                                <p>While transparent proxy does the job in terms of preserving the client source IP in the HTTP requests the backend web server
 receives it has a few drawbacks in terms of performance and availability risk. Because the original client IP is inserted
 as the source IP of the connection that is made to the backend a new connection has to be made for every request in order
 not to re-use connections from other client IPs. This will impact performance negatively. While WSM deployed as either Reverse
 or Routing is very easy to bypass if both nodes in a cluster fails because all that needs to be done is to change a NAT rule
 or a static route is gets a little more complicated when it is proxying transparently because the backend web servers are
 configured to use the WSM cluster as a gateway. This means that each backend web server has to be reconfigured to restore
 availability in the unlikely event that both WSM nodes in a cluster fails.
            </p>
                                                <div class="note" title="Note" style="margin-left: 0.5in;margin-right: 0.5in;">
                                                    <table border="0" summary="Note">
                                                        <tr>
                                                            <td rowspan="2" align="center" valign="top" width="25">
                                                                <img alt="[Note]" src="../../../Resources/Images/note.png" />
                                                            </td>
                                                            <th align="left">Note</th>
                                                        </tr>
                                                        <tr>
                                                            <td align="left" valign="top">
                                                                <p>Because the original client source IP appears to be the source IP for the backend web server receiving the request it needs
 to have WSM configured as the default gateway in order for the web server response to come back through WSM. This also means
 that it will be complicated and error prone at best to implement use Transparent Proxy in high performance deployments where
 WSM is deployed in combination with a load balancer.
                        </p>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                                <div class="sect4" title="1.7.4.1.&#160;Configuring Transparent Proxy">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h5 class="title"><a name="d0e3907"></a>1.7.4.1.&#160;Configuring Transparent Proxy
                        </h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>To minimize the availability impact on the web properties the configuration of Transparent Proxy should be performed in the
 following order:
               </p>
                                                    <div class="variablelist">
                                                        <dl>
                                                            <dt><span class="term">Web Security Manager</span>
                                                            </dt>
                                                            <dd>
                                                                <div class="itemizedlist">
                                                                    <ul class="itemizedlist" type="disc">
                                                                        <li class="listitem">
                                                                            <p>If WSM is deployed as a cluster, create a cluster interface with an VIP that is reachable by the backend web servers in System
 : Clustering.
                                 </p>
                                                                        </li>
                                                                        <li class="listitem">
                                                                            <p>Enable IP Forwarding in Services : Network &gt; Network routing.</p>
                                                                        </li>
                                                                        <li class="listitem">
                                                                            <p>Make sure that routing does not violate network segmentation settings by editing the segmentation table in Services : Network
 &gt; Network routing. By default routing cannot traverse network interfaces.
                                 </p>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                            </dd>
                                                            <dt><span class="term">Backend web servers</span>
                                                            </dt>
                                                            <dd>
                                                                <div class="itemizedlist">
                                                                    <ul class="itemizedlist" type="disc">
                                                                        <li class="listitem">
                                                                            <p>Configure backend web servers to use WSM as default gateway.</p>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                            </dd>
                                                        </dl>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="customfooter">
         © 2005 - 2014 Alert Logic inc.
         
      </div>
                                        <div class="navfooter">
                                            <hr width="100%" size="0" align="center" />
                                            <table width="100%" summary="Navigation footer">
                                                <tr>
                                                    <td width="40%" align="left"><a accesskey="p" href="ref_services_virtual_host_throttling.htm">Prev</a>&#160;
               </td>
                                                    <td width="20%" align="center"><a accesskey="u" href="ref_services_virtual_host.htm">Up</a>
                                                    </td>
                                                    <td width="40%" align="right">&#160;<a accesskey="n" href="ref_services_virtual_host_redirects.htm">Next</a></td>
                                                </tr>
                                                <tr>
                                                    <td width="40%" align="left" valign="top">1.6.&#160;HTTP Request and Connection Throttling&#160;</td>
                                                    <td width="20%" align="center"><a accesskey="h" href="index.htm">Home</a>
                                                    </td>
                                                    <td width="40%" align="right" valign="top">&#160;1.8.&#160;Redirects</td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>