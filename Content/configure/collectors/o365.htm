<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation_Skin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-toc-path="Configure|Collectors" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta name="zd-site-verification" content="9muqcovj07pyvoduai2al" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../Skins/Favicons/browserconfig.xml" />
        <meta name="description" content="Learn how to configure the Office 365 collector and integrate it with Alert Logic in the Application Registry page to start collecting log data that can generate authentication incidents and logs in the Alert Logic console." />
        <meta tags="office365, o365, office 365" />
        <link rel="apple-touch-icon" sizes="1545x1545" href="../../../Skins/Favicons/AlertLogic_Logo_2C_RGB_V_Standard.png" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon.png" />
        <link rel="icon" sizes="96x96" href="../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" /><title>Configure Microsoft Office 365 Log Collector</title>
        <meta http-equiv="Cache-control" content="no-cache" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <style>@import url('https://richg-github.github.io/al-styles/override-main.css');

</style>
        <link href="../../Resources/Stylesheets/MainStyles.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.next-topic-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.separator-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.print-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.expand-all-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.collapse-all-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link rel="apple-touch-icon" sizes="1545x1545" href="../../../Skins/Favicons/AlertLogic_Logo_2C_RGB_V_Standard.png" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon.png" />
        <link rel="icon" sizes="96x96" href="../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_Toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                        <div class="button-group-container-left">
                                            <button class="button needs-pie previous-topic-button" title="Navigate previous" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate previous">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie next-topic-button" title="Navigate next" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate next">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <div class="button-separator">
                                            </div>
                                            <button class="button needs-pie print-button" title="Print">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Print">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Expand all">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <div role="main" id="mc-main-content">
                                        <h1>Configure <span class="mc-variable ALVariables.Office_365_1 variable">Microsoft Office 365</span> Log Collector</h1>
                                        <div class="note">
                                            <p>The instructions in this document are for the <span class="mc-variable ALVariables.Company variable">Alert Logic</span> <a href="../application-registry.htm" class="MCXref xref">Application Registry</a> setup  of the <span class="mc-variable ALVariables.Office_365_1 variable">Microsoft Office 365</span> log collector. If you have to reference instructions or information for the older setup of the log collector, see <a href="../../prepare/office365-log-collector.htm" class="MCXref xref">Set Up Collection of Microsoft Office 365 Logs</a>. </p>
                                        </div>
                                        <p>The <span class="mc-variable ALVariables.Company variable">Alert Logic</span> <span class="mc-variable ALVariables.Office_365_1 variable">Microsoft Office 365</span> collector is an <span class="mc-variable ALVariables.AWS variable">AWS</span>-based API Poll (PAWS) log collector library mechanism designed to collect logs. You can find <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> logs collected with keyword search in the <span class="mc-variable ALVariables.ALUI_1 variable">Alert Logic console</span> <a href="../../get-started/search-a.htm" class="MCXref xref">Get Started with Search</a> page. <span class="mc-variable ALVariables.Company variable">Alert Logic</span> also generates security incidents from <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> logs in the <a href="../../analyze/incidents.htm" class="MCXref xref">Incidents</a> page. For more information about authentication application security content, see <a href="../../analyze/security-incidents.htm" class="MCXref xref">Authentication Application Security Incidents</a>.


 

 
 </p>
                                        <p>The <span class="mc-variable ALVariables.Company variable">Alert Logic</span> <span class="mc-variable ALVariables.Office_365_1 variable">Microsoft Office 365</span> collector can collect from these specific <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> content streams:</p>
                                        <ul>
                                            <li>Audit logs from <span class="mc-variable ALVariables.Azure variable">Azure</span> Active Directory</li>
                                            <li>Audit logs from <span class="mc-variable ALVariables.Office_365_1 variable">Microsoft Office 365</span> Exchange</li>
                                            <li>Audit logs from SharePoint</li>
                                            <li>General audit logs</li>
                                        </ul>
                                        <p>A single <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> collector can collect logs from any or all the content streams that you configure in the <span class="mc-variable ALVariables.ALUI variable">Alert Logic console</span>. These audit logs are collected through Microsoft Stream. For more information on Microsoft Stream, go to <a href="https://docs.microsoft.com/en-us/stream/audit-logs">Audit logs in Microsoft Stream</a>.</p>
                                        <p>You must complete the following to successfully configure your <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> Log Collector:</p>
                                        <ol>
                                            <li value="1"><a href="#Register" class="MCXref xref">Register a new Office 365 web application</a>
                                            </li>
                                            <li value="2"><a href="#Set" class="MCXref xref">Set up Active Directory security permissions</a>
                                            </li>
                                            <li value="3"><a href="#Configur" class="MCXref xref">Configure collection in the Alert Logic console</a>
                                            </li>
                                        </ol>
                                        <h2><a name="Register"></a>Register a new <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> web application</h2>
                                        <p>In the <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> portal, you must register a new <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> web application to collect <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> logs.</p>
                                        <p><b>To register an <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> web application:</b>
                                        </p>
                                        <ol>
                                            <li value="1">Log into the <a href="https://portal.office.com/"><span class="mc-variable ALVariables.Office_365 variable">Office 365</span> portal</a> as an Active Directory tenant administrator.</li>
                                            <li value="2"> In the left menu,  click <b>Azure Active Directory</b>.</li>
                                            <li value="3">Select <b>App Registrations</b>, and then click <b>+ New application registration</b>.</li>
                                            <li value="4">Provide the following information in the fields:<ul><li>Enter a name for the application <span style="font-family: 'Microsoft Sans Serif'">—</span>for example, alo365collector.</li><li>Under <b>Supported account types</b>, select <b>Single tenant</b> .</li><li>Under <b>Redirect URI (optional)</b>, leave the Redirect URI field blank. </li></ul></li>
                                            <li value="5">Click <b>Register</b>. Note the Application (client) ID, for example, a261478c-84fb-42f9-84c2-de050a4babe3, and the Directory (tenant) ID. </li>
                                        </ol>
                                        <h2><a name="Set"></a>Set up Active Directory security permissions</h2>
                                        <p>You must set up Active Directory security permissions for the application you created so it can read threat intelligence data and activity reports for your organization.</p>
                                        <p><b>To set up Active Directory permissions:</b>
                                        </p>
                                        <ol>
                                            <li value="1">On the main panel under the new application, click <b>View API Permissions</b>, and then click <b>+ Add a permission</b>.</li>
                                            <li value="2">Locate and click <b><span class="mc-variable ALVariables.Office_365 variable">Office 365</span> Management APIs</b>, and then click <b>Select</b>.</li>
                                            <li value="3">In <b>Application permissions</b>, expand and select <b>ActivityFeed.Read</b>, <b>ActivityReports.ReadDlp</b>, and <b>ServiceHealth.Read</b>.</li>
                                            <li value="4">Ensure all necessary permissions are selected, and then click <b>Add permissions</b>.</li>
                                            <li value="5">Click <b>Grant admin consent</b>, and then click <b>Accept</b> to confirm. </li>
                                            <div class="note">Only the Active Directory tenant administrator can grant permissions to an Azure Active Directory application.</div>
                                            <li value="6">On the left navigation area, select <b>Certificates &amp; secrets</b>, and then click <b>+ New client secret</b>. </li>
                                            <li value="7">Type a key <b>Description</b> and set the expiration to <b>Never</b>.</li>
                                            <li value="8">Click <b>Add</b>.</li>
                                            <li value="9">
Save the value (client secret), which you will need later.</li>
                                        </ol>
                                        <div>
                                            <h2><a name="Configur"></a>Configure collection in the <span class="mc-variable ALVariables.ALUI_1 variable">Alert Logic console</span></h2>
                                            <p>After you register a new <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> application and set up permissions, you must complete the log collection configuration process in the <span class="mc-variable ALVariables.ALUI_1 variable">Alert Logic console</span>. This configuration is an account-level integration, which means you can configure more than one instance of <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> collection. This capability is useful when  more than one instance of the application exists.</p>
                                            <p>To access the Application Registry page, click the menu icon (<img src="../../Resources/Images/dashboard/menu-icon.png" style="vertical-align: bottom;" />) from the Dashboards page. Click <img src="../../Resources/Images/dashboard/configure-icon.png" style="vertical-align: bottom;" /> <b>Configure</b>, and then click <b>Application Registry</b>. </p>
                                            <p><b>To add a new application collection</b>:</p>
                                            <ol>
                                                <li value="1">In the Application Registry, click the <b>Microsoft</b> tile, and then under <b>Productivity Applications</b>, click <span style="font-weight: bold;" class="mc-variable ALVariables.Office_365 variable">Office 365</span><b> Logs</b>. </li>
                                                <li value="2">In the <b>Application Name</b> field, enter a name for this <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> collection instance. 
                </li>
                                                <li value="3">Under Collection Method and Policy, in the <b>Client ID</b>&#160;field, enter the <span class="mc-variable ALVariables.Azure variable">Azure</span> Client ID&#160;associated with your registered <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> application. </li>
                                                <li value="4">In the <b>Client Secret</b>, enter your client secret. </li>
                                                <li value="5">In the <b>Tenant ID</b> field, enter your tenant ID. To find your <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> tenant ID, see <a href="https://support.office.com/en-gb/article/find-your-office-365-tenant-id-6891b561-a52d-4ade-9f39-b492285e2c9b">Find your Office 365 tenant ID</a>.</li>
                                                <li value="6">Select the content streams from which you want to collect logs. </li>
                                                <li value="7">(Optional) Enter a <b>Collection Start</b> time using a format such as (2020-01-01T16:00:00Z). If the <b>Collection Start</b> field is left blank, only logs generated after you configure this collection instance will be collected. 
            <div class="note"><p>The collection start time determines how far back you want <span class="mc-variable ALVariables.Company variable">Alert Logic</span> to collect logs if data already exists in your account. <span class="mc-variable ALVariables.Company variable">Alert Logic</span> can only collect logs up to 30 days prior to the date you configured this collection instance. 
</p></div></li>
                                                <li value="8">Click <b>ADD</b>.
Wait a few minutes for the application to create and appear in your application list. Do not click <b>ADD</b> again.  <![CDATA[                    ]]><div class="note"><span class="mc-variable ALVariables.Company variable">Alert Logic</span> <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> accounts for some third-party product APIs that may fail if attempting to pull log data for an older timeframe that is not available. The <span class="mc-variable ALVariables.Company variable">Alert Logic</span> <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> collector does not attempt an invalid request to the API, and instead moves the target collection date to the earliest valid date available.</div></li>
                                            </ol>
                                            <p>In the Applications List tab, if you configured your application correctly, within approximately 10 minutes you will Configured next to the application. For more information about how to add instances or manage existing collecting applications, see <a href="../application-registry.htm#Configur" class="MCXref xref">Manage your configured applications</a>.</p>
                                            <h2>Security content for Incidents</h2>
                                            <p><span class="mc-variable ALVariables.Company variable">Alert Logic</span> builds collectors to capture data from <span class="mc-variable ALVariables.Office_365 variable">Office 365</span> and various other applications to create security content that is used to generate incidents for key security use cases. The following security incidents are available for <span class="mc-variable ALVariables.Office_365 variable">Office 365</span>:</p>
                                            <ul>
                                                <li>Administrative Actions</li>
                                                <li>User Login AD</li>
                                                <li>User Behavior AD</li>
                                            </ul>
                                            <p>For more information about authentication application security content, see <a href="../../analyze/security-incidents.htm" class="MCXref xref">Authentication Application Security Incidents</a>.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>