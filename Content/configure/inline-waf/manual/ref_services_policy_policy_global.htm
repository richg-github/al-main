<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation_Skin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-toc-path="Configure|Inline WAF|Web Application Firewall&#160;Manual|Web Application Firewall" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta name="zd-site-verification" content="9muqcovj07pyvoduai2al" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="1545x1545" href="../../../../Skins/Favicons/AlertLogic_Logo_2C_RGB_V_Standard.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>Website Global Policy</title>
        <meta http-equiv="Cache-control" content="no-cache" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <style>@import url('https://dl.dropboxusercontent.com/s/q5nt7ghnm4mfv88/override-main.css');

</style>
        <link href="../../../Resources/Stylesheets/MainStyles.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.next-topic-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.separator-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.print-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.expand-all-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.collapse-all-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link rel="apple-touch-icon" sizes="1545x1545" href="../../../../Skins/Favicons/AlertLogic_Logo_2C_RGB_V_Standard.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_Toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                        <div class="button-group-container-left">
                                            <button class="button needs-pie previous-topic-button" title="Navigate previous" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate previous">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie next-topic-button" title="Navigate next" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate next">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <div class="button-separator">
                                            </div>
                                            <button class="button needs-pie print-button" title="Print">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Print">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Expand all">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <div role="main" id="mc-main-content">
                                        <div>
                                            <h1 id="WebsiteGlobalPolicy" data-magellan-target="WebsiteGlobalPolicy">Website Global Policy</h1>
                                            <div>
                                                <p>The <span class="mc-variable ALVariables.WAF_1 variable">Alert Logic Managed Web Application Firewall (WAF)</span> Website Global Policy page includes the following sections. Click on the link to go to the corresponding section to learn more: </p>
                                                <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 1280px)" class="nocontent menu _Skins_menuInBody mc-component">
                                                    <li><a href="#WebsiteGlobalPolicy">Website Global Policy</a>
                                                    </li>
                                                    <ul>
                                                        <ul>
                                                            <ul>
                                                                <li><a href="#Validatestaticrequestsseparately">Validate static requests separately
</a>
                                                                </li>
                                                                <li><a href="#URLpathvalidation">URL path validation
</a>
                                                                </li>
                                                                <li><a href="#DeniedURLpaths">Denied URL paths
                     </a>
                                                                </li>
                                                                <li><a href="#QueryandCookievalidation">Query and Cookie validation
</a>
                                                                </li>
                                                                <li><a href="#Headersvalidation">Headers validation
</a>
                                                                </li>
                                                                <li><a href="#Attacksignaturesusage">Attack signatures usage
</a>
                                                                </li>
                                                                <li><a href="#SessionandCSRFprotection">Session and CSRF protection
                     </a>
                                                                </li>
                                                                <li><a href="#TrustedclientsIPwhitelisting">Trusted clients - IP whitelisting
                     </a>
                                                                </li>
                                                                <li><a href="#Trusteddomains">Trusted domains
</a>
                                                                </li>
                                                                <li><a href="#Evasionprotection">Evasion protection
</a>
                                                                </li>
                                                                <li><a href="#Timerestrictedaccess">Time restricted access
                     </a>
                                                                </li>
                                                                <li><a href="#Inputvalidationclasses">Input validation classes
</a>
                                                                </li>
                                                            </ul>
                                                        </ul>
                                                    </ul>
                                                </ul>
                                            </div>
                                            <div>
                                                <p>To go to the documentation for the previous section of <span class="mc-variable ALVariables.WAF_1 variable">Alert Logic Managed Web Application Firewall (WAF)</span>, see <a href="ref_services_policy_proto_restrictions.htm" class="MCXref xref">Protocol Restrictions </a>. To go to  the documentation for next section in the <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> section, see <a href="ref_services_policy_web_applications.htm" class="MCXref xref">Web Applications
</a>.</p>
                                                <p><b>To access the Website global policy section in the <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> management interface</b>:</p>
                                                <ol>
                                                    <li value="1">On the left panel, under Services, click <b>Websites</b>. </li>
                                                    <li value="2">On the Websites page, click the website you want to manage. </li>
                                                    <li value="3">Under <span class="mc-variable ALVariables.WAF_2 variable">WAF</span>, click <b>Policy</b>, and then scroll down to the Website policy section. </li>
                                                </ol>
                                            </div>
                                            <p>If you want to see all the settings on the Policy page, on the upper-right corner, change  the <b>Display preset</b> to <b>Advance</b>. </p>
                                        </div>
                                        <p>To save configuration changes or edits you make to any features and options, you must click <b>Save</b> on the lower-right of the section or page where you are making changes. Click <b>apply changes</b> on the upper-left corner of the page, and then click <b>OK</b>. Your changes will not be stored if you do not properly save your changes. </p>
                                        <div class="orderedlist">
                                            <h4 class="title" id="Validatestaticrequestsseparately" data-magellan-target="Validatestaticrequestsseparately">Validate static requests separately
<a name="ref_services_policy_policy_global.htm#global_static"></a></h4>
                                            <p>The Static content policy allows requests without parameters based on <span class="emphasis"><em style="font-style: normal;">file extension</em></span> (i.e. .gif) and <span class="emphasis"><em style="font-style: normal;">allowed path characters</em></span>.
            </p>
                                            <p>To define a static content policy enter or edit <b><span class="guilabel">file extensions</span></b> and <b><span class="guilabel">allowed path characters</span></b>.
            </p>
                                            <div class="variablelist">
                                                <dl>
                                                    <dt><span class="term">File extension</span>
                                                    </dt>
                                                    <dd>
                                                        <p>The file extension is defined as a list of comma separated values.</p>
                                                    </dd>
                                                    <dt><span class="term">Allowed path characters</span>
                                                    </dt>
                                                    <dd>
                                                        <p>Allowed path characters are defined by selecting them on a list.</p>
                                                        <p>The letter A denotes all international alphanumeric characters and other characters are represented by their glyph, their
 UTF-8 number and a description.
                     </p>
                                                    </dd>
                                                </dl>
                                            </div>
                                            <p>As static content is not supposed to have any parameters (hence the denotation "static") only requests without parameters
 and with the method <code class="literal">GET</code> are validated against this rule.
            </p>
                                            <p>It is possible to allow static requests in general.</p>
                                            <div class="informaltable">
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                    <colgroup>
                                                        <col width="25%" align="left" />
                                                        <col width="75%" align="left" />
                                                    </colgroup>
                                                    <tbody>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Allow all static requests</span></b>
                                                                <p>Radio button</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>If selected, requests without parameters like requests for graphic elements, stylesheets, javascript, etc. are allowed in
 general.
                           </p>
                                                                <p>Allowing all static requests is faster but less secure as only input to web applications will be inspected when this option
 is enabled.
                           </p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Validate static requests path and extension </span></b>
                                                                <p>Radio button</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>If selected, requests without parameters like requests for graphic elements, stylesheets, javascript, etc. are validated using
 allowed path extension and allowed path characters.
                           </p>
                                                                <p>Default: <code class="literal">&lt;selected&gt;</code></p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Allowed path characters</span></b>
                                                                <p>List of check boxes</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Allowed path characters are defined by selecting them on a the list which appears when activating the button <b><span class="guibutton">Edit</span></b>.
                           </p>
                                                                <p>In the list the letter A denotes all international alphanumeric characters and other characters are represented by their glyph,
 their UTF-8 number and a description.
                           </p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>All characters in the list</p>
                                                                        </dd>
                                                                        <dt><span class="term">Input example</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <div class="itemizedlist">
                                                                                <ul class="itemizedlist" type="disc">
                                                                                    <li class="listitem">
                                                                                        <p>Hyphen-minus ("-", UTF-8: 2d)</p>
                                                                                    </li>
                                                                                    <li class="listitem">
                                                                                        <p>All international alphanumeric</p>
                                                                                    </li>
                                                                                    <li class="listitem">
                                                                                        <p>Space (" ", UTF-8: 20)</p>
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>The path characters in the input example above.</p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Allowed static file extensions</span></b>
                                                                <p>Input field</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>The file extension is defined as a list of comma separated values.</p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>A list of comma separated file extensions without a trailing period.</p>
                                                                        </dd>
                                                                        <dt><span class="term">Input example</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>css,png,ico,jpg,js,jpeg,gif,swf</p>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>css,png,ico,js,jpg,jpeg,gif,swf</p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Validate cookies for static requests</span></b>
                                                                <p>Check box</p>
                                                            </td>
                                                            <td align="left">
                                                                <p>Enable / disable validation of cookies for requests for static content.</p>
                                                                <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <h4 class="title" id="URLpathvalidation" data-magellan-target="URLpathvalidation">URL path validation
<a name="ref_services_policy_policy_global.htm#global_url"></a></h4>
                                            <p>The URL regular expressions filter matches URLs without parameters on a proxy global basis. If a request matches any of the
 defined regular expressions, it will be marked as valid by <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> and forwarded to the back-end server.
            </p>
                                            <p>For examples of global URL regular expressions, please refer to <a class="xref" href="ref_services_policy_global_regular_expressions.htm#ap_global_url_regular_expressions" title="Table&#160;5.6.&#160;Examples of global URL regular expressions" alt="Table&#160;5.6.&#160;Examples of global URL regular expressions">Examples of global URL regular expressions</a>.</p>
                                            <div class="note">
                                                <p>Full match is implied for each regular expression, meaning that each will match from the start to the end of the request (a
 caret ^ and dollar $ will be appended if not already present).
</p>
                                            </div>
                                            <div class="informaltable">
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                    <colgroup>
                                                        <col width="25%" align="left" />
                                                        <col width="75%" align="left" />
                                                    </colgroup>
                                                    <tbody>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Negative validation</span></b>
                                                                <p>Check box</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Select or clear to enable validation of the path element of the URL against negative signatures.</p>
                                                                <p>Paths not matching attack signatures will be allowed.</p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Positive validation</span></b>
                                                                <p>Check box</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Select or clear to enable positive validation of the path element of the request URL.</p>
                                                                <p>Paths matching one of the regular expressions in the list will be allowed.</p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Allowed path</span></b>
                                                            </td>
                                                            <td align="left">
                                                                <p>In the list enter one or more regular expressions defining the global path policy.</p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>Valid regular expressions.</p>
                                                                        </dd>
                                                                        <dt><span class="term">Input example</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>(/[\w\-]+)+\.(htm|html|shtml|pdf|asp|aspx|php|jsp)</p>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">None</code>
                                                                            </p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <h4 class="title" id="DeniedURLpaths" data-magellan-target="DeniedURLpaths"><a name="global_burl"></a>Denied URL paths<![CDATA[
                     ]]></h4>
                                            <p>The URL regular expressions block filter matches URLs without parameters on a proxy global basis. If a request matches any
 of the defined regular expressions it will instantly be blocked.
            </p>
                                            <p>Suppose for instance that a global paths policy rule allows all URL paths's with the extension ".php" but that you want to
 block access to all resources in the /admin directory - including subdirectories. To do that simply add the policy rule "/admin/".
            </p>
                                            <div class="note" title="Note" style="margin-left: 0.5in;margin-right: 0.5in;">
                                                <p>The expressions are matching from left to right. Full match is not implied but matching always start at start of line. This
 implies that for instance the expression /admin will match any URI starting with /admin</p>
                                            </div>
                                            <div class="informaltable">
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                    <colgroup>
                                                        <col width="25%" align="left" />
                                                        <col width="75%" align="left" />
                                                    </colgroup>
                                                    <tbody>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Denied path</span></b>
                                                                <p>Input fields</p>
                                                            </td>
                                                            <td align="left">
                                                                <p>In the list enter one or more regular expressions defining the global denied path policy.</p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>A valid regular expressions</p>
                                                                        </dd>
                                                                        <dt><span class="term">Input example</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>/admin (any request starting with "/admin")</p>
                                                                            <p>/testarea (any request starting with "/testarea")</p>
                                                                            <p>.+\.php (any request for files with the extension ".php")</p>
                                                                            <p>.+\.htm([^l]|$) (block .htm but allow .html)</p>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">none</code>
                                                                            </p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left">
                                                                <p align="left"><b><span class="guilabel">Add predefined</span></b>
                                                                </p>
                                                                <p align="left">Drop-down list</p>
                                                            </td>
                                                            <td align="left">
                                                                <p>Select one of the following predefined regular expressions:</p>
                                                                <ul>
                                                                    <li> Block directory browsing </li>
                                                                    <li>Generic - Block access to admin path</li>
                                                                </ul>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div class="sect3" title="1.4.4.&#160;Query and Cookie validation">
                                                <h4 class="title" id="QueryandCookievalidation" data-magellan-target="QueryandCookievalidation">Query and Cookie validation
<a name="ref_services_policy_policy_global.htm#global_parm"></a></h4>
                                                <p>Depending on the web server and web application technology and design of the web applications on the back end web server cookie
 names and values may in some cases be parsed as part of a general request object with the risk that client request cookies
 may be used to bypass validation controls. It is therefore recommended that cookies are parsed and validated as an integral
 part of the client query. That is as request parameters.
            </p>
                                                <p><span class="mc-variable ALVariables.WAF_2 variable">WAF</span> parses cookies and when learning is enabled the Learner maps cookie values as global parameters.</p>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left" />
                                                            <col width="75%" align="left" />
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Cookie validation enabled</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td align="left">
                                                                    <p>If enabled client request cookies will be parsed and validated as request parameters.</p>
                                                                    <p>Default: <code class="literal">enabled</code></p>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <h5 class="title">Validation
</h5>
                                                <p>In the global parameters section, parameters which all or many URLs have in common can be added. For instance in many CMS
 systems an URL can be viewed in a printer friendly version by adding a specific parameter to the URL.
               </p>
                                                <p>When adding parameters to the list the name of the parameter is interpreted by <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> as regular expressions.
 Like with the global URL-regular expressions full match from start to end is implied. The value can either be a regular expression
 or a predefined input validation class.
               </p>
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                    <colgroup>
                                                        <col width="25%" align="left" />
                                                        <col width="75%" align="left" />
                                                    </colgroup>
                                                    <tbody>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable global parameter signature based negative matching</span></b>
                                                                <p>Check box</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Select or clear the check box <b><span class="guilabel">Enable global parameter signature based negative matching</span></b> to enable signature bases matching of parameter names and corresponding values.
                              </p>
                                                                <p>When learning is enabled for the website this option should be enabled as it ensures that parameters not being validated by
 positive policy rules are validated negatively and thus not rejected by default.
                              </p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable global parameter regexp matching</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Select or clear the check box <b><span class="guilabel">Enable global parameter regexp matching</span></b> to enable global parameter regexp matching.
                              </p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Name</span></b>
                                                                <p>Input fields</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>In the list enter a regular expression matching the parameter name or names you want to match.</p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>A valid regular expression.</p>
                                                                        </dd>
                                                                        <dt><span class="term">Input example</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <div class="itemizedlist">
                                                                                <ul class="itemizedlist" type="disc">
                                                                                    <li class="listitem">
                                                                                        <p><code class="literal">\w{1,32}_btn</code> - matches all parameter names which start with a string of up to 32 characters and ends with the specific string '_btn'.
                                                </p>
                                                                                    </li>
                                                                                    <li class="listitem">
                                                                                        <p><code class="literal">print</code> - matches the specific name print.
                                                </p>
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">None</code>
                                                                            </p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Type</span></b>
                                                                <p>Drop-down list</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Input validation type.</p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>Options from the drop-down list</p>
                                                                            <div class="variablelist">
                                                                                <dl>
                                                                                    <dt><span class="term">Class</span>
                                                                                    </dt>
                                                                                    <dd>
                                                                                        <p>A predefined named regular expression like <span class="emphasis"><em>numeric</em></span> or <span class="emphasis"><em>alphanumeric</em></span>. Editing the class definition will affect all policy components that uses it.
                                                </p>
                                                                                    </dd>
                                                                                    <dt><span class="term">Regexp</span>
                                                                                    </dt>
                                                                                    <dd>
                                                                                        <p>Regular expression. See<a class="xref" href="ref_services_policy_global_regular_expressions.htm#d0e12930" title="Table&#160;5.8.&#160;Examples of global parameters regular expressions" alt="Table&#160;5.8.&#160;Examples of global parameters regular expressions"> Examples of global parameters regular expressions</a>.
                                                </p>
                                                                                    </dd>
                                                                                    <dt><span class="term">Bypass</span>
                                                                                    </dt>
                                                                                    <dd>
                                                                                        <p>The parameter will be completely bypassed.</p>
                                                                                    </dd>
                                                                                </dl>
                                                                            </div>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">Class</code>
                                                                            </p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Update</span></b>
                                                                <p>Drop-down list</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Controls how the Learner handles the parameter.</p>
                                                                <p>When update is set to <code class="literal">manual</code> the parameter entry will not be maintained and updated by the Learner. When set to <code class="literal">auto</code> the entry will be maintained by the Learner.
                              </p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Value</span></b>
                                                                <p>Depends on <code class="literal">type</code></p>
                                                            </td>
                                                            <td align="left">
                                                                <p>Value for input validation.</p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <div class="itemizedlist">
                                                                                <ul class="itemizedlist" type="disc">
                                                                                    <li class="listitem">
                                                                                        <p>A class selected from the class drop-down list.</p>
                                                                                    </li>
                                                                                    <li class="listitem">
                                                                                        <p>A regular expression</p>
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <div class="itemizedlist">
                                                                                <ul class="itemizedlist" type="disc">
                                                                                    <li class="listitem">
                                                                                        <p>When <code class="literal">type</code> = <code class="literal">class</code>: <code class="literal">num</code></p>
                                                                                    </li>
                                                                                    <li class="listitem">
                                                                                        <p>When <code class="literal">type</code> = <code class="literal">regex</code>: <code class="literal">empty</code></p>
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                                <p>When type is <code class="literal">class</code> the corresponding regular expression of the input validation class is displayed to the right of the class selector.
                              </p>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <p>For examples of specifying global parameters using regular expressions please refer to <a class="xref" href="ref_services_policy_global_regular_expressions.htm#d0e12930" title="Table&#160;5.8.&#160;Examples of global parameters regular expressions" alt="Table&#160;5.8.&#160;Examples of global parameters regular expressions">Examples of global parameters regular expressions</a>.
               </p>
                                                <p>For more general examples using regular expressions for input validation please refer to <a class="xref" href="ref_services_policy_global_regular_expressions.htm#ap_validating_input_parameters" title="Table&#160;5.7.&#160;Examples of regular expressions for input validation" alt="Table&#160;5.7.&#160;Examples of regular expressions for input validation">Examples of regular expressions for input validation</a>.
               </p>
                                                <div class="note">
                                                    <p>Full match is implied for each regular expression, meaning that each will match from the start to the end of the request (a
 caret ^ and dollar $ will be appended if not already present).
                           </p>
                                                </div>
                                            </div>
                                            <div class="sect3" title="1.4.5.&#160;Headers validation">
                                                <h4 class="title" id="Headersvalidation" data-magellan-target="Headersvalidation">Headers validation
<a name="ref_services_policy_policy_global.htm#global_header"></a></h4>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left" />
                                                            <col width="75%" align="left" />
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Allow only RFC defined headers</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Enable / disable enforcement of strict HTTP compliant headers.</p>
                                                                    <p>If enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will enforce strict HTTP header compliance according the RFC standards and deny any custom
 HTTP header sent in the request.
                           </p>
                                                                    <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Input headers validation rules</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td align="left">
                                                                    <p>The header validation policy rules allow for enforcing a combination of positive and negative validation rules on either specific
 named headers or all headers. "All" header rules also applies to specific named headers.
                           </p>
                                                                    <p>For each header policy entry the options are: </p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Status</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">On</code> or <code class="literal">Off</code> - enabling or disabling the policy rule.
                                    </p>
                                                                            </dd>
                                                                            <dt><span class="term">Rule type</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">Negative</code> or <code class="literal">Positive</code> - Negative will look for the presence of strings matching the specified regular expression (like searching for Carriage Return
 in a header) and Positive will require the entire header value to match the specified regular expression.
                                    </p>
                                                                            </dd>
                                                                            <dt><span class="term">Match</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">General</code> or <code class="literal">Named</code> - General will apply the policy rule to all headers and Named will only apply the policy rule to a named header.
                                    </p>
                                                                            </dd>
                                                                            <dt><span class="term">Header</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>Only applies to <code class="literal">Named</code> header rules. The name of the header to validate using the specified regular expression.
                                    </p>
                                                                            </dd>
                                                                            <dt><span class="term">Regex</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>The regular expression specifying the validation rule for the header.</p>
                                                                            </dd>
                                                                            <dt><span class="term">Description</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>A description of the policy rule - like "XSS match tags".</p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <div class="sect4" title="1.4.5.1.&#160;Denied headers" data-mc-conditions="Primary.NOTinBHOOF">
                                                    <h5 class="title">Denied headers
<a name="d0e9777"></a></h5>
                                                    <p>Requests can be blocked/logged based on the value of a header.</p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable headers blocking</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Select or clear to enable blocking of requests based on header content.</p>
                                                                        <p>Requests with headers matching the blocking rules will denied.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Header</span></b>
                                                                        <p>Input fields</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Enter name of header to match.</p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Valid input</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>The name of an HTTP header</p>
                                                                                </dd>
                                                                                <dt><span class="term">Input example</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>User-Agent</p>
                                                                                </dd>
                                                                                <dt><span class="term">Default value</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">None</code>
                                                                                    </p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Allowed path</span></b>
                                                                        <p>Input fields</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Regular expression to match header value.</p>
                                                                        <p>Note that full match is not implied so the regex <code class="literal">string</code> will match any value containing "string".
                              </p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Valid input</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>Valid regular expressions.</p>
                                                                                </dd>
                                                                                <dt><span class="term">Input example</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>rogue-spam-bot</p>
                                                                                </dd>
                                                                                <dt><span class="term">Default value</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">None</code>
                                                                                    </p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="sect3" title="1.4.6.&#160;Attack signatures usage">
                                                <h4 class="title" id="Attacksignaturesusage" data-magellan-target="Attacksignaturesusage">Attack signatures usage
<a name="ref_services_policy_policy_global.htm#global_signatures"></a></h4>
                                                <p>The use of attack signatures can be enabled or disabled for each request method supported.</p>
                                                <div class="sect4" title="1.4.6.1.&#160;Negative filtering column">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h5 class="title"><a name="d0e9866"></a>Negative filtering column
                        </h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>The check boxes in the negative filtering column enable or disable the use of attack signatures for validating input. The settings
 only applies to requests or or request parts for which negative filtering is enabled.
               </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Attack Class</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>The name of the signature attack class</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">HEAD</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Select or clear to enable signature for method <code class="literal">HEAD</code>.
                              </p>
                                                                        <p>Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">GET</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Select or clear to enable signature for method <code class="literal">GET</code>.
                              </p>
                                                                        <p>Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">POST</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Select or clear to enable signature for method <code class="literal">POST</code>.
                              </p>
                                                                        <p>Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">PUT</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Select or clear to enable signature for method <code class="literal">PUT</code>.
                              </p>
                                                                        <p>Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">DELETE</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Select or clear to enable signature for method <code class="literal">DELETE</code>.
                              </p>
                                                                        <p>Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">MKCOL</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Select or clear to enable signature for method <code class="literal">MKCOL</code>.
                              </p>
                                                                        <p>Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">COPY</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Select or clear to enable signature for method <code class="literal">COPY</code>.
                              </p>
                                                                        <p>Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">MOVE</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Select or clear to enable signature for method <code class="literal">MOVE</code>.
                              </p>
                                                                        <p>Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">PROPFIND</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Select or clear to enable signature for method <code class="literal">PROPFIND</code>.
                              </p>
                                                                        <p>Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">PROPPATCH</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Select or clear to enable signature for method <code class="literal">PROPPATCH</code>.
                              </p>
                                                                        <p>Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">LOCK</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Select or clear to enable signature for method <code class="literal">LOCK</code>.
                              </p>
                                                                        <p>Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">UNLOCK</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Select or clear to enable signature for method <code class="literal">UNLOCK</code>.
                              </p>
                                                                        <p>Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">PATCH</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Select or clear to enable signature for method <code class="literal">PATCH</code>.
                              </p>
                                                                        <p>Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="sect4" title="1.4.6.2.&#160;Classification column" data-mc-conditions="Primary.NOTinBHOOF">
                                                    <h5 class="title"><a name="d0e9943"></a>Classification column
                        </h5>
                                                    <p>The check boxes in the classification column enable or disable the use of attack signatures for classifying log records and
 learning samples. If for instance the website takes HTML as in input like some CMS'es and bulletin board systems does this
 is likely to trick the Cross Site Scripting (XSS) signature. If it is not possible to white-list the IP address(es) from which
 the input originates or to only allow access to the CMS via VPN it might be necessary to disable the XSS signature in order
 to ensure that the Learner gets the data samples.
               </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left" data-mc-conditions="Primary.NOTinBHOOF"><b><span class="guilabel">Attack Class</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p data-mc-conditions="Primary.NOTinBHOOF">The name of the signature attack class</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left" data-mc-conditions="Primary.NOTinBHOOF"><b><span class="guilabel">HEAD</span></b>
                                                                        <p data-mc-conditions="Primary.NOTinBHOOF">Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p data-mc-conditions="Primary.NOTinBHOOF">Select or clear to enable signature for method <code class="literal">HEAD</code>.
                              </p>
                                                                        <p data-mc-conditions="Primary.NOTinBHOOF">Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left" data-mc-conditions="Primary.NOTinBHOOF"><b><span class="guilabel">GET</span></b>
                                                                        <p data-mc-conditions="Primary.NOTinBHOOF">Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p data-mc-conditions="Primary.NOTinBHOOF">Select or clear to enable signature for method <code class="literal">GET</code>.
                              </p>
                                                                        <p data-mc-conditions="Primary.NOTinBHOOF">Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left" data-mc-conditions="Primary.NOTinBHOOF"><b><span class="guilabel">POST</span></b>
                                                                        <p data-mc-conditions="Primary.NOTinBHOOF">Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p data-mc-conditions="Primary.NOTinBHOOF">Select or clear to enable signature for method <code class="literal">POST</code>.
                              </p>
                                                                        <p data-mc-conditions="Primary.NOTinBHOOF">Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left" data-mc-conditions="Primary.NOTinBHOOF"><b><span class="guilabel">OPTIONS</span></b>
                                                                        <p data-mc-conditions="Primary.NOTinBHOOF">Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p data-mc-conditions="Primary.NOTinBHOOF">Select or clear to enable signature for method <code class="literal">OPTIONS</code>.
                              </p>
                                                                        <p data-mc-conditions="Primary.NOTinBHOOF">Default: Signature dependent.</p>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="sect3" title="1.4.7.&#160;Session and CSRF protection">
                                                <h4 class="title" id="SessionandCSRFprotection" data-magellan-target="SessionandCSRFprotection"><a name="global_session"></a>Session and CSRF protection
                     </h4>
                                                <p><span class="mc-variable ALVariables.WAF_2 variable">WAF</span> has the ability to protect against session hijacking and CSRF (Cross Site Request Forgery) by:</p>
                                                <div class="orderedlist">
                                                    <ol class="orderedlist" style="list-style-type: decimal;">
                                                        <li class="listitem" value="1">
                                                            <p>Binding client IPs to session cookies by issuing a validation cookie containing a cryptographic token (a checksum) which validates
 session id + client IP + a secret for each client request.
                     </p>
                                                        </li>
                                                        <li class="listitem" value="2">
                                                            <p>By binding forms to sessions and verifying the origin of the form through insertion of a form validation parameter containing
 a cryptographic token which proves that the action formulator (the system issuing the page containing a form with an action)
 knows a session specific secret.
                     </p>
                                                        </li>
                                                        <li class="listitem" value="3">
                                                            <p>Additionally idle sessions are timed out in order to prevent users from staying logged in making them vulnerable to CSRF attacks.</p>
                                                        </li>
                                                    </ol>
                                                </div>
                                                <p>When the web system issues a session cookie <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> detects it and issues a corresponding session validation
 cookie. In order to be able to identify the session cookie it is necessary to enter the name of the cookie containing the
 session id - i.e. PHPSESSID, JSESSIONID, ASPSESSIONID, SID.
            </p>
                                                <p>An easy way to identify the session cookie name for the site you are configuring protection is to establish a session with
 the site (logging in, visiting the site or whatever actions are necessary to make the site issue a session cookie) and then
 view the cookies issued for that specific site in your browser.
            </p>
                                                <div class="variablelist">
                                                    <dl>
                                                        <dt><span class="term">Finding session cookie name in Firefox</span>
                                                        </dt>
                                                        <dd>
                                                            <p>When a session is established view the cookie in <b><span class="guimenu">Tools</span></b>-&gt;<b><span class="guisubmenu">Options</span></b>+<b><span class="guimenu">Privacy</span></b>-&gt;<b><span class="guimenuitem">Cookies</span></b>-&gt;<b><span class="guimenuitem">Show Cookies</span></b></p>
                                                            <p>Enter the domain name of the site in the search field.</p>
                                                        </dd>
                                                    </dl>
                                                </div>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left" />
                                                            <col width="75%" align="left" />
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Session ID name</span></b>
                                                                    <p>Input field</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>The name of the cookie containing the session identifier.</p>
                                                                    <p>This field value is required to enable session and form (CSRF) protection.</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>Any regular expression matching the name of the session id cookie.</p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">PHPSESSID</code>
                                                                                </p>
                                                                                <p><code class="literal">JSESSIONID</code>
                                                                                </p>
                                                                                <p><code class="literal">ASPSESSIONID</code>
                                                                                </p>
                                                                                <p><code class="literal">ASPSESSIONID\w+ (matching asp session id's with random strings appended to the name like <code class="literal">ASPSESSIONIDAAQTDQRT</code>)</code>
                                                                                </p>
                                                                                <p><code class="literal">SID</code>
                                                                                </p>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">&lt;none&gt;</code>
                                                                                </p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Secret for signing checksums</span></b>
                                                                    <p>Input field</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>A hard to guess string used to generate session cookie validation tokens.</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>Any string</p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>didnqdndnwqdnqdagdiddbuqh3shjethdnssbvsunjn</p>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">&lt;random value&gt;</code>
                                                                                </p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Idle session timeout</span></b>
                                                                    <p>Input field</p>
                                                                </td>
                                                                <td align="left">
                                                                    <p>Idle session timeout specifies the maximum duration of an idle session before it is dropped resulting in the user being logged
 out from the web site.
                           </p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>A number (integer) in the interval 10 - 86400 (24 hours).</p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">900</code> - 15 minutes
                                    </p>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">600</code>
                                                                                </p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <div class="sect4" title="1.4.7.1.&#160;Cookie flags">
                                                    <h5 class="title"><a name="d0e10174"></a>Cookie flags
                        </h5>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="107px" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Add Secure flag to session cookie</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Add secure flag to session cookie to instruct users browser to only send the cookie over an SSL connection.</p>
                                                                        <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Make session cookie HttpOnly</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Add HttpOnly flag to session cookie to instruct users browser to make the cookie inaccessible to client side script.</p>
                                                                        <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b>Add SameSite flag to session cookie</b>
                                                                        <p>Checkbox</p>
                                                                        <p>Drop-down option</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Add SameSite flag to session cookie for none, lax, or strict.</p>
                                                                        <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="sect4" title="1.4.7.2.&#160;HSTS - HTTP Strict Transport Security">
                                                    <h5 class="title"><a name="d0e10210"></a>&#160;HSTS - HTTP Strict Transport Security
                        </h5>
                                                    <p>HSTS is a mechanism enabling web sites to declare themselves accessible only via secure connections - HTTPS. The policy is
 declared by web sites via the Strict-Transport-Security HTTP response header field. When enabling HSTS in <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> the Strict-Transport-Security
 header will be injected in server responses if it is not already present.
               </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable HSTS</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Add Strict-Transport-Security header to backend server responses if not already present.</p>
                                                                        <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Max age</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Max age corresponds to the required "max-age" directive in the HSTS directive and specifies the number of days, after the
 reception of the STS header field, during which the User Agent (browser) regards the web server (from which the HSTS header
 was received) as a Known HSTS Host..
                              </p>
                                                                        <p>Default: <code class="literal">&lt;365&gt;</code></p>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="sect4" title="1.4.7.3.&#160;Session protection configuration">
                                                    <div>
                                                        <h5 class="title"><a name="d0e10248"></a>Session protection configuration
                        </h5>
                                                    </div>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable session protection</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Enable / disable validation of session identifiers.</p>
                                                                        <p>If enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will issue a validation cookie containing a cryptographic token (a checksum) which validates
 session id + client IP + secret for signing checksums (above) for each client request.
                              </p>
                                                                        <p>The validation cookie is named __PFV__ and is issued whenever <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> detects a set_cookie with a cookie name
 matching the value configured (above) from the web site to protect.
                              </p>
                                                                        <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Session violation action</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>What <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> should do when an invalid session id is detected.</p>
                                                                        <p>Session violation actions</p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Block request</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>The request is blocked and a session cookie with max-age=0 is sent back to the client resulting in the clients browser to
 expire the session cookie.
                                       </p>
                                                                                </dd>
                                                                                <dt><span class="term">Drop session, allow request</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>The session cookie is removed from the request before the request is allowed to reach the web system.</p>
                                                                                    <p>In the deny log the request will be listed with action = strip.</p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                        <p>Default: <code class="literal">&lt;Drop session, allow request&gt;</code></p>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="sect4" title="1.4.7.4.&#160;CSRF protection configuration">
                                                    <h5 class="title"><a name="d0e10305"></a>CSRF protection configuration
                        </h5>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Generate request form validation tokens (CSRF protection)</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Enable / disable generation of request form validation tokens (CSRF protection)</p>
                                                                        <p>If enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will parse web system responses of type text/* searching for form tags. When forms tags are
 detected a session specific checksum validating the form action is inserted as a hidden parameter (named ___pffv___) to the
 form. 
                              </p>
                                                                        <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                        <p>Now go to <b><span class="guimenu">Policy</span></b>-&gt;<b><span class="guimenuitem">Web applications</span></b> to enable request validation for specific applications (see <a class="xref" href="ref_services_policy_web_applications.htm#ref_services_policy_web_applications.htm#web_applications_settings" title="1.5.1.&#160;Web application settings" alt="1.5.1.&#160;Web application settings">Web application settings</a>). If configured the Learner will learn and configure CSRF protection for applications.
                              </p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Form violation action</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>What <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> should do when an invalid request is detected.</p>
                                                                        <p>Form violation actions</p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Block request</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>The request is blocked and a session cookie with max-age=0 is sent back to the client resulting in the clients browser to
 expire the session cookie.
                                       </p>
                                                                                </dd>
                                                                                <dt><span class="term">Drop session, allow request</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>The session cookie is removed from the request before the request is allowed to reach the web system.</p>
                                                                                    <p>In the deny log the request will be listed with action = strip.</p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                        <p>Default: <code class="literal">&lt;Drop session, allow request&gt;</code></p>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <h5 data-mc-conditions="Primary.beta">Exceptions</h5>
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;" data-mc-conditions="Primary.beta">
                                                    <colgroup>
                                                        <col width="25%" align="left" />
                                                        <col width="75%" align="left" />
                                                    </colgroup>
                                                    <tbody>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left" data-mc-conditions="Primary.beta"><b><span class="guilabel">Enable CSRF&#160;Exception by Regular Expression</span></b>
                                                                <p data-mc-conditions="Primary.beta">Check box</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p data-mc-conditions="Primary.beta">&#160;</p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left" data-mc-conditions="Primary.beta"><b><span class="guilabel">Regular Expression</span></b>
                                                                <p data-mc-conditions="Primary.beta">Input field</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p data-mc-conditions="Primary.beta">&#160;</p>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <div class="sect4" title="1.4.7.5.&#160;Request authorization configuration">
                                                    <h5 class="title"><a name="d0e10370"></a>&#160;Request authorization configuration
                        </h5>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Enable request authorization</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Enable / disable request authorization for configured web applications.</p>
                                                                        <p>If enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will authorize access to resources based on session validity.</p>
                                                                        <p>Request authorization is only enforced for resources for which this feature is enabled.</p>
                                                                        <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                        <p>Now go to <b><span class="guimenu">Policy</span></b>-&gt;<b><span class="guimenuitem">Web applications</span></b> to enable request authorization for specific applications and other resources incl. static files (see <a class="xref" href="ref_services_policy_web_applications.htm#ref_services_policy_web_applications.htm#web_applications_settings" title="1.5.1.&#160;Web application settings" alt="1.5.1.&#160;Web application settings">Web application settings</a>).
                              </p>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="sect3" title="1.4.8.&#160;Trusted clients - IP whitelisting">
                                                <h4 class="title" id="TrustedclientsIPwhitelisting" data-magellan-target="TrustedclientsIPwhitelisting"><a name="global_trusted_clients"></a>Trusted clients - IP whitelisting
                     </h4>
                                                <p>List if IP addresses which are trusted / whitelisted. The in- and output filters can be configured to be bypassed for the
 whitelisted addresses.
            </p>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left" />
                                                            <col width="75%" align="left" />
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Whitelist</span></b>
                                                                    <p>Input field</p>
                                                                </td>
                                                                <td align="left">
                                                                    <p>Per default, requests originating from any IP address (0.0.0.0/0) is affected when Pass Through Mode is enabled.</p>
                                                                    <p>The white list allows for the definition of specific IP address(es) or networks for which Pass Through Mode is enabled.</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>IP address with net mask (IP/mask) in CIDR notation</p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">192.168.0.8/32</code> - the IP address 192.168.0.8
                                    </p>
                                                                                <p><code class="literal">192.168.0.0/24</code> - IP addresses 192.168.0.0 - 255
                                    </p>
                                                                                <p><code class="literal">192.168.0.8/29</code> - IP addresses 192.168.0.8-15
                                    </p>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">&lt;none&gt;</code>
                                                                                </p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <div class="sect4" title="1.4.8.1.&#160;IP pass through">
                                                    <h5 class="title"><a name="ref_pass_through_mode"></a>&#160;IP pass through
                        </h5>
                                                    <p>IP pass through allows for configuring overriding of filter actions based on the source of the request.</p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable HTTP request blocking bypass for trusted clients</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Enable / disable HTTP pass through</p>
                                                                        <p>With Pass Through for trusted clients enabled, all requests will be forwarded to the real server, but will be otherwise handled
 the usual way (ie. <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will learn about the site and log any would be blocked requests not matching the applied
 access control list).
                              </p>
                                                                        <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Enable IP network blocking bypass for trusted clients</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Enable / disable network blocking pass through</p>
                                                                        <p>When enabled, IP addresses listed as trusted clients will be included in the global list of IP addresses that are allowed
 to bypass network blocking and DoS mitigation controls.
                              </p>
                                                                        <p>Note that the address will not be bypassed unless network blocking bypass is allowed in <b><span class="guimenu">Services</span></b>-&gt;<b><span class="guimenuitem">Network</span></b></p>
                                                                        <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="sect3" title="1.4.9.&#160;Trusted domains">
                                                <h4 class="title" id="Trusteddomains" data-magellan-target="Trusteddomains">Trusted domains
<a name="ref_services_policy_policy_global.htm#global_trusted_domains"></a></h4>
                                                <p>The trusted domains is a whitelist of domains which is composed of 1) the domain of the website proxy virtual host and the
 domains of the host names in Virtual host aliases and 2) a list of other trusted domains which can be entered manually.
            </p>
                                                <p>The effective list of trusted domains is used in Remote File Inclusion signatures to leave out URLs targeting hosts within
 the list and when validating redirects to allow redirects to hosts within the list.
            </p>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left" />
                                                            <col width="75%" align="left" />
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Effective trusted domains</span></b>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>This is the effective list of trusted domains, i.e. the automatically generated list of the domain of the website proxy virtual
 host, the domains of the host names in Virtual host aliases and the manually entered domains (if any).
                           </p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Other trusted domains</span></b>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Enter additional domains to the list of trusted domains.</p>
                                                                    <p>Domains are separated by newline.</p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Include other trusted domains in domains list</span></b>
                                                                </td>
                                                                <td align="left">When enabled the manually entered domains will be added to the effective trusted domains list.</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="sect3" title="1.4.10.&#160;Evasion protection">
                                                <h4 class="title" id="Evasionprotection" data-magellan-target="Evasionprotection">Evasion protection
<a name="ref_services_policy_policy_global.htm#global_evasion_protection"></a></h4>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left" />
                                                            <col width="75%" align="left" />
                                                        </colgroup>
                                                        <tbody>
                                                            <tr data-mc-conditions="Primary.beta">
                                                                <td style="border-right: 0.5pt solid;" align="left"><b>Block overlong UTF-8 sequences</b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td align="left">
                                                                    <p align="left">&#160;</p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Block multiple and %u encoded requests</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td align="left">
                                                                    <p>Enable / disable blocking of multiple (or %u) encoded requests.</p>
                                                                    <p>In an attempt to evade detection attackers often try to encode requests multiple times.</p>
                                                                    <p>If enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will block requests which after being decoded still contains encoded characters.</p>
                                                                    <p>Default: <code class="literal">&lt;enabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <div class="sect4" title="1.4.10.1.&#160;Duplicate parameter names">
                                                    <h5 class="title"><a name="d0e10618"></a>Duplicate parameter names
                        </h5>
                                                    <p>If duplicate parameter names are allowed, wrongly configured web application behavior may result in <span class="mc-variable ALVariables.WAF_1 variable">Alert Logic Managed Web Application Firewall (WAF)</span>
 not learning the web site correctly and may also lead to <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> bypassing vulnerabilities depending on the target application/web
 server technology.
               </p>
                                                    <p>An attacker may submit a request to the web application with several parameters with the same name depending on the technology
 the web application may react in one of the following ways:
               </p>
                                                    <div class="orderedlist">
                                                        <ol class="orderedlist" style="list-style-type: decimal;">
                                                            <li class="listitem" value="1">
                                                                <p>It may only take the data from the first or the last occurrence of the duplicate parameter</p>
                                                            </li>
                                                            <li class="listitem" value="2">
                                                                <p>It may take the data from all the occurrences and concatenate them in a list or put them in an array</p>
                                                            </li>
                                                        </ol>
                                                    </div>
                                                    <p>In the case of concatenation it will allow an attacker to distribute the payload of for instance an SQL injection attack across
 several duplicate parameters.
               </p>
                                                    <p>As an example ASP.NET concatenates duplicate parameters using ',' so <code class="literal">/index.aspx?page=22&amp;page=42</code> would result in the backend web application parsing the value of the 'page' parameter as page=22,42 while <span class="mc-variable ALVariables.WAF_2 variable">WAF</span>
 may see it as two parameters with values 22 and 42.
               </p>
                                                    <p>This behavior allows the attacker to distribute an SQL injection attack across the three parameters.</p>
                                                    <p><code class="literal">/index.aspx?page='select data&amp;page=1 from table</code> would result in the backend web application parsing the value of the 'page' parameter as 'select data, 1 from table while
 <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> may see it as two parameters with values <code class="literal">'select data</code> and <code class="literal">1 from table</code>.
               </p>
                                                    <p>By default, when <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> validates parameters negatively it automatically concatenates the payload of duplicate
 parameters. It is mostly in the case where a positive application or global rule allows a specific parameter with an input
 validation rule that makes room for attacks like the above the parameter duplication problem exists. In the page example above
 the attack would be stopped because the page parameter would be learned as numeric input (an integer). This would not allow
 text input like in the example above. Nevertheless it is important to configure <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> to mimic the target web
 applications parsing of requests as closely as possible.
               </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Block duplicate parameter names</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Enable / disable blocking of duplicate parameter names.</p>
                                                                        <p>If enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> blocks requests containing duplicate parameter names.</p>
                                                                        <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Join duplicate parameter names</span></b>
                                                                        <p>Check box</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Enable / disable concatenation duplicate parameters.</p>
                                                                        <p>If enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will concatenate the values of the duplicate parameters using the configured join separator
 (below).
                              </p>
                                                                        <p>Default: <code class="literal">&lt;enabled&gt;</code></p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Join separator</span></b>
                                                                        <p>Input field</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Character(s) used for separating concatenated parameter values.</p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Valid input</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>A string of 0 to 5 characters</p>
                                                                                </dd>
                                                                                <dt><span class="term">Input example (in quotes)</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">','</code> - comma, ASP and ASP.NET
                                       </p>
                                                                                </dd>
                                                                                <dt><span class="term">Default value</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">''</code> - empty string
                                       </p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    <p>The best option is to disallow duplicate parameter names. It may not be practical though as the use of duplicate parameters
 may be intended in some applications - the most prominent example being PHP which parses parameter names suffixed with <code class="literal">[]</code> as an array - like par1[]=22&amp;par1[]=42 becoming array(22,42). If this feature is not in use block it.
               </p>
                                                    <p>If the application technology is ASP/IIS or ASP.NET/IIS and it is not possible to disallow duplicate parameters the recommended
 setting is to join duplicate parameters using ',' as in the join separator example above.
               </p>
                                                </div>
                                            </div>
                                            <div class="sect3" title="1.4.11.&#160;Time restricted access">
                                                <h4 class="title" id="Timerestrictedaccess" data-magellan-target="Timerestrictedaccess"><a name="global_time_restriction"></a>Time restricted access
                     </h4>
                                                <p>Access to a website can be restricted on a time basis.</p>
                                                <div class="sect4" title="1.4.11.1.&#160;Opening hours">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h5 class="title"><a name="d0e10735"></a>Opening hours
                        </h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>For each weekday enter opening hours.</p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Opens</span></b>
                                                                        <p>Input field</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Time the website opens on the weekday.</p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Valid input</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>24h time string in the format hh:mm.</p>
                                                                                </dd>
                                                                                <dt><span class="term">Input example</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>08:00</p>
                                                                                </dd>
                                                                                <dt><span class="term">Default value</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">00:00</code>
                                                                                    </p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Closes</span></b>
                                                                        <p>Input field</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Time the website closes on the weekday.</p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Valid input</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>24h time string in the format hh:mm.</p>
                                                                                </dd>
                                                                                <dt><span class="term">Input example</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>18:00</p>
                                                                                </dd>
                                                                                <dt><span class="term">Default value</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">24:00</code>
                                                                                    </p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="sect4" title="1.4.11.2.&#160;Website is closed">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h5 class="title"><a name="d0e10805"></a>Website is closed
                        </h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>To specify dates where the website is closed enter a list of dates in the format mm/dd separated by whitespace, comma or semicolon.</p>
                                                </div>
                                                <div class="sect4" title="1.4.11.3.&#160;When website is closed redirect to">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h5 class="title"><a name="d0e10810"></a>When website is closed redirect to
                        </h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>URL to redirect the visitor to when website is closed.</p>
                                                    <p>This field is required.</p>
                                                </div>
                                            </div>
                                            <div class="sect3" title="1.4.12.&#160;Input validation classes">
                                                <h4 class="title" id="Inputvalidationclasses" data-magellan-target="Inputvalidationclasses">Input validation classes
<a name="ref_services_policy_policy_global.htm#global_classes"></a></h4>
                                                <p>Characters classes are useful when you want to use a predeclared set of criteria used by <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> for input request
 validation. Eg. if you have lots of HTML forms that use an input field "email", you can define a class and a regular expression
 which defines what a valid e-mail address is. This class can then be used throughout the entire policy.
            </p>
                                                <p>When a <code class="literal">class</code> is changed, all affected policy elements are automatically updated to reflect the change.
            </p>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left" />
                                                            <col width="75%" align="left" />
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Rank</span></b>
                                                                    <p>Read only</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>The class rank when used by the Learner.</p>
                                                                    <p>To change the rank, place the cursor in one of the classes input fields. The rank number will be indented. Use the buttons
                              <b><span class="guibutton">Move up</span></b> and <b><span class="guibutton">Move down</span></b> in the lower button panel to change the class' rank.
                           </p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Name</span></b>
                                                                    <p>Input field</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>The class' name.</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>A text string. No spaces or special characters.</p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">my_class</code>
                                                                                </p>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">&lt;none&gt;</code>
                                                                                </p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Value</span></b>
                                                                    <p>Input field</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>The class regular expression.</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>A valid regular expression.</p>
                                                                                <p>Full match is implied for each regular expression, meaning that each will match from the start to the end of the request (a
 caret ^ and dollar $ will be appended if not already present).
                                    </p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">[A-Za-z]{1,32}</code> - a string of max. 32 7-bit letters.
                                    </p>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">&lt;none&gt;</code>
                                                                                </p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">X</span></b>
                                                                    <p>Button</p>
                                                                </td>
                                                                <td align="left">
                                                                    <p>Mark class for deletion.</p>
                                                                    <p>When classes are saved the marked classes will be deleted.</p>
                                                                    <p>When deleting classes that are in use in the policy you will be prompted to accept replacement of the deleted classes with
 existing classes.
                           </p>
                                                                    <p>Learner data samples using deleted classes will be deleted.</p>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <p>For more information about classes and their corresponding regular expressions, refer to <a class="xref" href="ref_services_policy_global_regular_expressions.htm#top" title="1.8.&#160;Regular expressions" alt="1.8.&#160;Regular expressions">Regular expressions</a>.
            </p>
                                                <div class="sect4" title="1.4.12.1.&#160;Negative signatures policy">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h5 class="title"><a name="ref_classes_negative_policy"></a>&#160;Negative signatures policy
                        </h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>Some user input is so complex and unpredictable that, to avoid false positives, positive validation of input ends up being
 very general and loose. An example of this is free text input fields which often get mapped to the input validation class
 "printable" which basically allows all printable characters. It is often better validate such input negatively - which <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> does by default.
               </p>
                                                    <p><span class="mc-variable ALVariables.WAF_2 variable">WAF</span> determines if an input should be validated negatively based on the input validation class rank. By default
 the threshold is the class <code class="literal">Printable</code>. If a parameters input is learned/configured to be the class configured as threshold the signatures policy will be used instead
 of the class regular expression.
               </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Move up</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Change the rank of the selected class.</p>
                                                                        <p>To move the class upwards. Select the class by clicking anywhere in the class row. When selected the class rank number is
 highlighted and indented. Click <b><span class="guilabel">Move up</span></b> to move the class one step upwards.
                              </p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Move down</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Change the rank of the selected class.</p>
                                                                        <p>Works as described above.</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Add new</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Add new class. When clicked an empty row will appear at the bottom of the class list. Fill out the blanks and place the class
 in the class hierarchy with the move buttons.
                           </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Use negative checking above and including class rank</span></b>
                                                                        <p>Drop-down list</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>The class rank above and including which input will be validated negatively.</p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Valid input</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>Values in the drop-down list.</p>
                                                                                </dd>
                                                                                <dt><span class="term">Input example</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">standard</code>
                                                                                    </p>
                                                                                </dd>
                                                                                <dt><span class="term">Default value</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">printable</code>
                                                                                    </p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                        <p>To disable negative class checking select <code class="literal">disabled</code> in the list.
                              </p>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            <p><![CDATA[                ]]></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>