<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation_Skin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-toc-path="Configure|Inline WAF|Web Application Firewall&#160;Manual|Web Application Firewall" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta name="zd-site-verification" content="9muqcovj07pyvoduai2al" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="1545x1545" href="../../../../Skins/Favicons/AlertLogic_Logo_2C_RGB_V_Standard.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>Output Filter
</title>
        <meta http-equiv="Cache-control" content="no-cache" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <style>@import url('https://dl.dropboxusercontent.com/s/q5nt7ghnm4mfv88/override-main.css');

</style>
        <link href="../../../Resources/Stylesheets/MainStyles.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.next-topic-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.separator-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.print-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.expand-all-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.collapse-all-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link rel="apple-touch-icon" sizes="1545x1545" href="../../../../Skins/Favicons/AlertLogic_Logo_2C_RGB_V_Standard.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_Toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                        <div class="button-group-container-left">
                                            <button class="button needs-pie previous-topic-button" title="Navigate previous" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate previous">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie next-topic-button" title="Navigate next" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate next">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <div class="button-separator">
                                            </div>
                                            <button class="button needs-pie print-button" title="Print">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Print">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Expand all">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <div role="main" id="mc-main-content">
                                        <div>
                                            <h1 id="OutputFilter" data-magellan-target="OutputFilter">Output Filter
<a name="ref_services_policy_output_filter.htm"></a></h1>
                                            <div>
                                                <p>The <span class="mc-variable ALVariables.WAF_1 variable">Alert Logic Managed Web Application Firewall (WAF)</span> Output Filter page includes the following sections. Click on the link to go to the corresponding section to learn more: </p>
                                                <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 1280px)" class="nocontent menu _Skins_menuInBody mc-component">
                                                    <li><a href="#OutputFilter">Output Filter
</a>
                                                    </li>
                                                    <ul>
                                                        <ul>
                                                            <ul>
                                                                <li><a href="#Backendservercloaking">Backend server cloaking
</a>
                                                                </li>
                                                                <li><a href="#Outputheadersvalidationandrewriting">Output headers validation and rewriting
</a>
                                                                </li>
                                                                <li><a href="#Outputbodyvalidationandrewriting">Output body validation and rewriting
</a>
                                                                </li>
                                                            </ul>
                                                        </ul>
                                                    </ul>
                                                </ul>
                                            </div>
                                            <div>
                                                <p>To go to the documentation for the previous section of <span class="mc-variable ALVariables.WAF_1 variable">Alert Logic Managed Web Application Firewall (WAF)</span>, see <a href="ref_services_policy_web_applications.htm" class="MCXref xref">Web Applications
</a>. To go to  the documentation for next section in the <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> section, see <a href="ref_services_policy_global_regular_expressions.htm" class="MCXref xref">Regular Expressions</a>.</p>
                                                <p><b>To access the Output filter section in the <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> management interface</b>:</p>
                                                <ol>
                                                    <li value="1">On the left panel, under Services, click <b>Websites</b>. </li>
                                                    <li value="2">On the Websites page, click the website you want to manage. </li>
                                                    <li value="3">Under <span class="mc-variable ALVariables.WAF_2 variable">WAF</span>, click <b>Policy</b>, and then scroll down to the Output filter section. </li>
                                                </ol>
                                            </div>
                                            <p>If you want to see all the settings on the Policy page, on the upper-right corner, change  the <b>Display preset</b> to <b>Advance</b>. </p>
                                            <p>To save configuration changes or edits you make to any features and options, you must click <b>Save</b> on the lower-right of the section or page where you are making changes. Click <b>apply changes</b> on the upper-left corner of the page, and then click <b>OK</b>. Your changes will not be stored if you do not properly save your changes. </p>
                                            <p>The <span class="emphasis"><em style="font-style: normal;">Output filter section</em></span> allows for configuring policies for rewriting headers and body of server responses sent to the client.
         </p>
                                            <div class="sect3" title="1.6.1.&#160;Backend server cloaking">
                                                <div class="titlepage">
                                                    <div>
                                                        <div>
                                                            <h4 class="title" id="Backendservercloaking" data-magellan-target="Backendservercloaking">Backend server cloaking
<a name="ref_services_policy_output_filter.htm#output_cloak"></a></h4>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p>A typical web server gives out a lot of information about it's version, installed software, operating system, etc.</p>
                                                <p>This information is completely irrelevant for normal HTTP/HTTPS communication between clients and web server. However, attackers
 and worms can misuse this information to craft more targeted attacks on a vulnerable web application or server.
            </p>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left">
                                                            </col>
                                                            <col width="75%" align="left">
                                                            </col>
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Server ID</span></b>
                                                                    <p>Input field</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>The server name string that is sent in respones to clients in the Server header.</p>
                                                                    <p>When the website proxy is created the value is extracted from the backend server response in a short form.</p>
                                                                    <p>Leave the field empty to omit the Server header from responses.</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>Alphanumeric, space, dash, underscore and period.</p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>Apache/2.2</p>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>Backend server banner without details</p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable Web server cloaking mode</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Enable / disable Web server cloaking mode.</p>
                                                                    <p>If enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> removes web server information from the response sent back from the back-end server before
 forwarding it to the client thus protecting the web application and server from leaking potentially sensitive information.
 This includes stripping of all HTTP headers that start with "X-". Eg. header "X-Powered-By: PHP/4.4.0" will be removed.
                           </p>
                                                                    <p>Default: <code class="literal">&lt;enabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Intercept backend error pages</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Intercept error pages with error code 400 or higher sent by the backend web server and replace with a general error page.</p>
                                                                    <p>Configure error pages in <a class="xref" href="ref_services_deny_and_error_handling.htm#ref_services_deny_and_error_handling_error.htm" title="2.2.&#160;Error messages" alt="2.2.&#160;Error messages">Error messages</a>.</p>
                                                                    <p>Default: &lt;checked&gt;</p>
                                                                    <p>When enabled the original error code can be replaced with a general one (ie. 405 &gt; 404) or the original error can be sent
 to the client.
                           </p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Show original backend error code</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>The original error code is sent and the error code and name is displayed in the error message.</p>
                                                                            </dd>
                                                                            <dt><span class="term">Generalize backend error codes</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>A general error code is sent and displayed.</p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Exclude status codes</span></b>
                                                                    <p>Input field</p>
                                                                </td>
                                                                <td align="left">
                                                                    <p>Exclude specific error codes from error interception (if enabled).</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>list of error codes separated by space</p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>401 403</p>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>&lt;empty&gt;</p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="sect3" title="1.6.2.&#160;Output headers validation and rewriting">
                                                <div class="titlepage">
                                                    <div>
                                                        <div>
                                                            <h4 class="title" id="Outputheadersvalidationandrewriting" data-magellan-target="Outputheadersvalidationandrewriting">Output headers validation and rewriting
<a name="ref_services_policy_output_filter.htm#output_header"></a></h4>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="sect4" title="1.6.2.1.&#160;Redirects validation">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h5 class="title">Redirects validation
<a name="ref_services_policy_redirects_validation"></a></h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>Redirects validation protects against attacks that redirect victims to phishing or malware sites through target applications
 that use untrusted data to determine the destination pages.
               </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left">
                                                                </col>
                                                                <col width="75%" align="left">
                                                                </col>
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Block redirects to non trusted domains</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>When enabled <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will validate redirects from the protected web applications and only allow redirects to
 domains in the <b><span class="guilabel">trusted domains</span></b> whitelist.
                              </p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Whitelist</span></b>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>The whitelist is the effective list of trusted domains.</p>
                                                                        <p>Redirects are allowed to hosts in the domains in this list.</p>
                                                                        <p>The list can be edited in Trusted domains ( See <a href="ref_services_policy_policy_global.htm#ref_services_policy_policy_global.htm#global_trusted_domains">Trusted Domains</a>) in the global policy section.
                              </p>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="sect4" title="1.6.2.2.&#160;Response headers rewriting">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h5 class="title">Response headers rewriting
<a name="d0e11710"></a></h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p><span class="mc-variable ALVariables.WAF_2 variable">WAF</span> allows for rewriting arbitrary response header values using regular expressions for matching the value
 to rewrite.
               </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left">
                                                                </col>
                                                                <col width="75%" align="left">
                                                                </col>
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable response header rewriting</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Check or clear the check box <b><span class="guilabel">Enable response header re-writing</span></b> to enable this feature.
                              </p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Header</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>In the list enter a the name of the header to match.</p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Valid input</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>Any header field.</p>
                                                                                </dd>
                                                                                <dt><span class="term">Input example</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <div class="itemizedlist">
                                                                                        <ul class="itemizedlist" type="disc">
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">Location</code> - matches a redirect response header.
                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p>FooBar - matches the custom header field FooBar.</p>
                                                                                            </li>
                                                                                        </ul>
                                                                                    </div>
                                                                                </dd>
                                                                                <dt><span class="term">Default value</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">none</code>
                                                                                    </p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Action</span></b>
                                                                        <p>Drop-down options</p>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Action to take if there is a search match.</p>
                                                                        <p>Replace: replace matched string with replace string.</p>
                                                                        <p data-mc-conditions="Primary.Draft Content">Strip:</p>
                                                                        <p data-mc-conditions="Primary.Draft Content">Insert: </p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Valid input</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>Drop-down options</p>
                                                                                </dd>
                                                                                <dt><span class="term">Default value</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">Replace</code>
                                                                                    </p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Search for</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>A regular expression matching the string to replace.</p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Valid input</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>A regular expression.</p>
                                                                                </dd>
                                                                                <dt><span class="term">Input example</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <div class="itemizedlist">
                                                                                        <ul class="itemizedlist" type="disc">
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal"><code class="literal">xxxhost\.xxx\.tld</code></code> - matches <code class="literal">xxxhost.xxx.tld</code></p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal"><code class="literal">[a-z]{1,32}\.xxx\.tld</code></code> - matches any host name in the xxx.tld domain consisting of characters a-z (case insensitive) with length 1 - 32 characters.
                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">http://</code> - matches http://
                                                </p>
                                                                                            </li>
                                                                                        </ul>
                                                                                    </div>
                                                                                </dd>
                                                                                <dt><span class="term">Default value</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">none</code>
                                                                                    </p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                        <p>Notice the use of backslash ("\") in the examples above to escape the metacharacter ".". Without escaping the "." it will
 be interpreted as a metacharacter matching any character resulting in the regular expression also matching strings like xxxyhost2xxx4tld
 and xxxhost_xxx_tld (a.o.).
                              </p>
                                                                        <p>The regular expressions matches case insensitive in a repetitive fashion meaning that if more than one instance of the search
 pattern is present in the string they will all be replaced.
                              </p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Replace with</span></b>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>A string to replace with</p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Valid input</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>Any text string</p>
                                                                                </dd>
                                                                                <dt><span class="term">Input example</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <div class="itemizedlist">
                                                                                        <ul class="itemizedlist" type="disc">
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal"><code class="literal">yyyhost.yyy.tld</code></code>
                                                                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">newhost.yyy.tld</code>
                                                                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">https://</code>
                                                                                                </p>
                                                                                            </li>
                                                                                        </ul>
                                                                                    </div>
                                                                                </dd>
                                                                                <dt><span class="term">Default value</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">none</code>
                                                                                    </p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="sect3" title="1.6.3.&#160;Output body validation and rewriting">
                                                <div class="titlepage">
                                                    <div>
                                                        <div>
                                                            <h4 class="title" id="Outputbodyvalidationandrewriting" data-magellan-target="Outputbodyvalidationandrewriting">Output body validation and rewriting
<a name="output_body"></a></h4>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p><span class="mc-variable ALVariables.WAF_2 variable">WAF</span> allows for parsing and rewriting the body of server responses. This is useful for screening (and replacing)
 output for confidential data like credit card numbers. Note however that rewriting server responses involves parsing the complete
 document and therefore will introduce added latency.
            </p>
                                                <p>It is important that the correct response content type is configured in <a href="ref_services_policy.htm#Web">Web application behavior</a>. </p>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="112px" align="left">
                                                            </col>
                                                            <col width="75%" align="left">
                                                            </col>
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Search for</span></b>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>A regular expression matching the string to replace.</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>A regular expression.</p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <div class="itemizedlist">
                                                                                    <ul class="itemizedlist" type="disc">
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal"><code class="literal">(?:\d{4}[\-\x20]?){2}\d{4,5}[\-\x20]?(?:\d{2,4})?</code></code> - matches a payment card number
                                             </p>
                                                                                        </li>
                                                                                    </ul>
                                                                                </div>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">none</code>
                                                                                </p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                    <p>As with the response header rewrite function the the regular expressions matches case insensitive in a repetitive fashion
 meaning that if more than one instance of the search pattern is present in the string they will all be replaced. Also meta
 characters should be escaped if they are to be interpreted literally.
                           </p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Action</span></b>
                                                                    <p>Drop-down options </p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Action to take if there is a search match.</p>
                                                                    <p>Replace: replace matched string with replace string.</p>
                                                                    <p>Block: block the rest of the response and log the violation.</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>Drop-down options</p>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">Replace</code>
                                                                                </p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Replace with</span></b>
                                                                </td>
                                                                <td align="left">
                                                                    <p>A string to replace with</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>Any text string</p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <div class="itemizedlist">
                                                                                    <ul class="itemizedlist" type="disc">
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal"><code class="literal">masked_payment_card</code></code>
                                                                                            </p>
                                                                                        </li>
                                                                                    </ul>
                                                                                </div>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">none</code>
                                                                                </p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <div class="sect4" title="1.6.3.1.&#160;Exceptions">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h5 class="title"><a name="d0e11970"></a>Exceptions
                        </h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p><span class="mc-variable ALVariables.WAF_2 variable">WAF</span> can be configured to not rewrite the response body if the request is originating from trusted clients
 or if the requested path matches a regular expression.
               </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Do not re-write from whitelisted IP's (trusted clients)</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">
                                                                        <p>Check or clear the check box to exclude requests from trusted clients / whitelisted IP from being rewritten.</p>
                                                                        <p>The list of trusted clients is edited in the <a href="ref_services_policy_policy_global.htm#global_trusted_clients">Global Policy</a> section. </p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Do not re-write from URIs matching regex</span></b>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Enter a regular expressions matching the path part of the requests to be excluded.</p>
                                                                        <p>Only responses with content types text/<em class="replaceable"><code>[sometype]</code></em> will be rewritten.
                              </p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Valid input</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>A valid regular expression</p>
                                                                                </dd>
                                                                                <dt><span class="term">Input example</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>^/forms/ (do not rewrite requests starting with /forms/)</p>
                                                                                    <p>^.+\.js (do not rewrite files with the extension ".js")</p>
                                                                                </dd>
                                                                                <dt><span class="term">Default value</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">none</code>
                                                                                    </p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>