<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation_Skin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta name="zd-site-verification" content="9muqcovj07pyvoduai2al" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="1545x1545" href="../../../../Skins/Favicons/AlertLogic_Logo_2C_RGB_V_Standard.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>Policy</title>
        <meta http-equiv="Cache-control" content="no-cache" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <style>@import url('https://dl.dropboxusercontent.com/s/q5nt7ghnm4mfv88/override-main.css');

</style>
        <link href="../../../Resources/Stylesheets/MainStyles.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.next-topic-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.separator-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.print-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.expand-all-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.button.collapse-all-button
{
	-pie-background: linear-gradient(transparent, transparent);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link rel="apple-touch-icon" sizes="1545x1545" href="../../../../Skins/Favicons/AlertLogic_Logo_2C_RGB_V_Standard.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_Toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                        <div class="button-group-container-left">
                                            <button class="button needs-pie previous-topic-button" title="Navigate previous" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate previous">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie next-topic-button" title="Navigate next" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate next">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <div class="button-separator">
                                            </div>
                                            <button class="button needs-pie print-button" title="Print">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Print">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Expand all">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                        </div>
                                    </div>
                                    <div role="main" id="mc-main-content">
                                        <div>
                                            <h1 id="Policy" data-magellan-target="Policy">Policy<a name="ref_services_policy.htm"></a></h1>
                                            <p>The Policy page is part of the <span class="mc-variable ALVariables.WAF_1 variable">Alert Logic Managed Web Application Firewall (WAF)</span> section in the web based management interface. To learn about all of the features in the <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> section, see <a href="ch_waf.htm" class="MCXref xref">WAF</a>.</p>
                                            <p>This page contains information for the following features found under the Policy section on the <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> page : </p>
                                            <div>
                                                <ul data-magellan="" data-animation-duration="250" data-active-class="selected" data-scroll-container=".body-container" data-scroll-container-on="only screen and (min-width: 1280px)" class="nocontent menu _Skins_menuInBody mc-component">
                                                    <li><a href="#Policy">Policy</a>
                                                    </li>
                                                    <ul>
                                                        <li><a href="#Basicoperation">Basic operation
</a>
                                                        </li>
                                                        <ul>
                                                            <li><a href="#WAFoperatingmodedefinitions">WAF operating mode definitions
</a>
                                                            </li>
                                                            <ul>
                                                                <li><a href="#Violations">Violations
</a>
                                                                </li>
                                                                <li><a href="#Contentviolations">Content violations
</a>
                                                                </li>
                                                                <li><a href="#Protocolviolations">Protocol violations
                           </a>
                                                                </li>
                                                            </ul>
                                                            <li><a href="#Requestparsing">Request parsing
</a>
                                                            </li>
                                                            <ul>
                                                                <li><a href="#Delimiters">Delimiters
                        </a>
                                                                </li>
                                                                <li><a href="#Responseencoding">Response encoding
                        </a>
                                                                </li>
                                                                <li><a href="#ContenttypePOSTrequests">Content type - POST requests
                        </a>
                                                                </li>
                                                                <li><a href="#Casesensitivity">Case sensitivity
                        </a>
                                                                </li>
                                                                <li><a href="#Requestheaderrewriting">Request header re-writing
                        </a>
                                                                </li>
                                                            </ul>
                                                            <li><a href="#Attackclasscriticality">Attack class criticality
</a>
                                                            </li>
                                                            <li><a href="#SourceIPtrackingandblocking">Source IP tracking and blocking
</a>
                                                            </li>
                                                            <ul>
                                                                <li><a href="#Immediateblacklisting">Immediate blacklisting
</a>
                                                                </li>
                                                                <li><a href="#Layer7sourceIPblocking">Layer 7 source IP blocking
</a>
                                                                </li>
                                                                <li><a href="#GeolocationIPaccesscontrol">Geolocation IP access control</a>
                                                                </li>
                                                            </ul>
                                                            <li><a href="#Externalnotification">External notification
</a>
                                                            </li>
                                                            <ul>
                                                                <li><a href="#Alertsandsummary">Alerts and summary
                        </a>
                                                                </li>
                                                                <li><a href="#Syslogalerts">Syslog alerts
                           </a>
                                                                </li>
                                                                <li><a href="#Emailalerts">Email alerts
                           </a>
                                                                </li>
                                                                <li><a href="#Attackclasscriticalitytologprioritymapping">Attack class criticality to log priority mapping
                        </a>
                                                                </li>
                                                            </ul>
                                                            <li><a href="#Denylogsettings">Deny log settings
</a>
                                                            </li>
                                                            <ul>
                                                                <li><a href="#Policyviolations">Policy violations
                        </a>
                                                                </li>
                                                                <li><a href="#Brokenrequests">Broken requests
                        </a>
                                                                </li>
                                                                <li><a href="#Logdatamasking">Log data masking
                        </a>
                                                                </li>
                                                            </ul>
                                                            <li><a href="#Accesslogsettings">Access log settings
                     </a>
                                                            </li>
                                                            <ul>
                                                                <li><a href="#Gettingviewingtheaccesslogfiles">Getting/viewing the access log files
                        </a>
                                                                </li>
                                                                <li><a href="#Accesslogformats">Access log formats
                        </a>
                                                                </li>
                                                                <li><a href="#AlertLogicManagedWebApplicationFirewallWAFCommon">Alert Logic Managed Web Application Firewall (WAF) Common
                           </a>
                                                                </li>
                                                                <li><a href="#CommonLogFormat">&#160;Common Log Format
                           </a>
                                                                </li>
                                                                <li><a href="#CommonLogFormatwithVirtualHost">Common Log Format with Virtual Host
                           </a>
                                                                </li>
                                                                <li><a href="#NCSAextendedcombined">&#160;NCSA extended/combined
                           </a>
                                                                </li>
                                                                <li><a href="#Customformat">&#160;Custom format
                           </a>
                                                                </li>
                                                                <li><a href="#Additionalfields">Additional fields
                           </a>
                                                                </li>
                                                            </ul>
                                                            <li><a href="#Responseinspection">Response inspection</a>
                                                            </li>
                                                            <ul>
                                                                <li><a href="#Responselogging">Response logging</a>
                                                                </li>
                                                                <li><a href="#Responseinspection1">Response inspection</a>
                                                                </li>
                                                            </ul>
                                                            <li><a href="#Mirrorproxypolicyfrommaster">Mirror proxy policy from master
                     </a>
                                                            </li>
                                                        </ul>
                                                    </ul>
                                                </ul>
                                            </div>
                                            <p>To go to the documentation for the previous section of <span class="mc-variable ALVariables.WAF_1 variable">Alert Logic Managed Web Application Firewall (WAF)</span>, see <a href="ref_services_policy.htm" class="MCXref xref">Policy</a>. To go to  the documentation for next subsection in the <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> section, see <a href="ref_services_policy_proto_restrictions.htm" class="MCXref xref">Protocol Restrictions </a>.</p>
                                            <p><b>To access the Policy page in the <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> management interface</b>:</p>
                                            <ol>
                                                <li value="1">On the left panel, under Services, click <b>Websites</b>. </li>
                                                <li value="2">On the Websites page, click the website you want to manage. </li>
                                                <li value="3">Under <span class="mc-variable ALVariables.WAF_2 variable">WAF</span>, click <b>Policy</b>. </li>
                                            </ol>
                                            <p>If you want to see all the settings on the Policy page, on the upper-right corner, change  the <b>Display preset</b> to <b>Advance</b>. </p>
                                        </div>
                                        <p>To save configuration changes or edits you make to any features and options, you must click <b>Save</b> on the lower-right of the section or page where you are making changes. Click <b>apply changes</b> on the upper-left corner of the page, and then click <b>OK</b>. Your changes will not be stored if you do not properly save your changes. </p>
                                        <div>
                                            <h2 id="Basicoperation" data-magellan-target="Basicoperation">Basic operation
<a name="ref_services_policy_operating_mode.htm"></a></h2>
                                        </div>
                                        <div>
                                            <h3 id="WAFoperatingmodedefinitions" data-magellan-target="WAFoperatingmodedefinitions"><span class="mc-variable ALVariables.WAF_2 variable">WAF</span> operating mode definitions
<a name="ref_services_policy_operating_mode.htm#mode_violation_action"></a></h3>
                                        </div>
                                        <p>Operating modes are sets of configurations defining what violations to block and what violations to just log. Two configurable
 and one non-configurable presets are available.
            </p>
                                        <div class="variablelist">
                                            <dl>
                                                <dt><span class="term" style="font-weight: bold;">Protect</span>: The protect mode preset by default blocks and logs all violations according to the access policy.</dt>
                                                <dt><span class="term" style="font-weight: bold;">Detect</span>: In the default detect mode preset, only logging occurs and no blocking protection is activated. Blocking protection that may occur in protect mode is logged and available for review in the deny log. Operating in the default detect mode is comparable
 to an intrusion detection system; it detects and logs activities but does not protect or prevent policy violations.
                     </dt>
                                                <dt><span class="term" style="font-weight: bold;">Pass</span>: In pass mode, all requests are passed through the website proxy. No requests are blocked and no logging is performed. As no
 filters are active in pass mode, it is not configurable.
                     </dt>
                                            </dl>
                                        </div>
                                        <p>For each violation, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> can be configured to either block and log or just log.</p>
                                        <div>
                                            <h4 id="Violations" data-magellan-target="Violations">Violations
<a name="ref_policy_mode_violations"></a></h4>
                                            <p>If you want to see all the settings on the Policy page, on the upper-right corner, change  the <b>Display preset</b> to <b>Advance</b>. </p>
                                        </div>
                                        <div class="sect5" title="1.2.1.1.1.&#160;Content violations">
                                            <h4 id="Contentviolations" data-magellan-target="Contentviolations">Content violations
<a name="d0e6231"></a></h4>
                                            <div class="informaltable"><a name="ref_table_content_violations"></a>
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                    <colgroup>
                                                        <col width="25%" align="left">
                                                        </col>
                                                        <col width="75%" align="left">
                                                        </col>
                                                    </colgroup>
                                                    <tbody>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Path unknown</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">No policy rules allow the path segment of the URL, either because it does not match a positive policy rule or because it matches
 a negative policy rule - a signature.
                              </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Path denied</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">The path is explicitly denied by an URL blocking policy rule.</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Query unknown</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">No positive policy rules match the name of the request parameter.</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Query illegal</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">No policy rules allow the value of the request parameter, either because it does not match a positive policy rule or because
 it matches a negative policy rule - a signature.
                              </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Session validation failed</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">The request session ID is not valid, either because the session token has been tampered with or hijacked.</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Form validation failed</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">The form submitted cannot be verified as having been issued by the web application in a response to a request from the current
 user session. This is an indication of a CSRF attack.
                              </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Session expired</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">The request session has exceeded the idle expiration threshold configured in <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> for the web application.</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Malformed XML</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">Submitted XML request is malformed and hence cannot be parsed and validated.</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Multiple encoded request</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">The request contains elements that are encoded more than twice or it contains elements that are encoded using %u-encoding.</td>
                                                        </tr>
                                                        <!-- Missing information for Unicode and %u encoding -->
                                                        <tr data-mc-conditions="Primary.beta">
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;font-weight: bold;" align="left">Illegal or malformed Unicode</td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">&#160;</td>
                                                        </tr>
                                                        <tr data-mc-conditions="Primary.beta">
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;font-weight: bold;" align="left">Illegal or malformed %u encoding</td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">&#160;</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Authorization failed</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">User is not authorized to access requested resource.</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Header unknown</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">Request header not RFC 2616 compliant.</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Header illegal</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">Header value failed strict validation.</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Header validation failed</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">Header value failed pragmatic validation.</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Output illegal</span></b>
                                                            </td>
                                                            <td align="left">Server response contains illegal string.</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div>
                                            <h4 id="Protocolviolations" data-magellan-target="Protocolviolations"><a name="d0e6323"></a>Protocol violations
                           </h4>
                                        </div>
                                        <div class="informaltable"><a name="ref_table_protocol_violations"></a>
                                            <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                <colgroup>
                                                    <col width="25%" align="left">
                                                    </col>
                                                    <col width="75%" align="left">
                                                    </col>
                                                </colgroup>
                                                <tbody>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">HTTP Protocol version</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">HTTP protocol version not allowed.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Method illegal</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">HTTP method not allowed.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Missing hostname</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Request does not specify host name.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Invalid hostname</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Not website proxy is configured for the requested host name.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Request line maximum length</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Entire request line (URI?query) exceeds allowed maximum length.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Request path maximum length</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Request path exceeds allowed maximum length.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Query string maximum length</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Request query exceeds allowed maximum length.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Content type not enabled</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Request content type is supported but not enabled.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Header name length</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Header name exceeds allowed maximum length.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Header value length</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Header value exceeds allowed maximum length.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Maximum number of headers</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Header number exceeds allowed maximum.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Upload attempt</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Upload attempted but upload not allowed.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Payload length exceeded</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">POST payload exceeds allowed maximum size.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Maximum number of upload files</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Number of files to upload in a request exceeds allowed maximum.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Total upload size</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Total size of upload files in request exceeds allowed maximum.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Maximum file size</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Size of a single upload file exceeds allowed maximum.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Cookie version not allowed</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Request cookie version not allowed.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Maximum number of cookies</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Number of cookies in request exceeds allowed maximum.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Cookie name length</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Name of a cookie exceeds allowed maximum length.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Cookie value length</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Value of a cookie exceeds allowed maximum length.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Maximum number of GET parameters</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">GET parameter number exceeds allowed maximum.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">GET parameter name length</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">GET parameter name exceeds allowed maximum length.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">GET parameter value length</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">GET parameter value exceeds allowed maximum length.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">GET parameter combined length</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Combined length of GET parameter name and value exceeds allowed maximum length.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Maximum number of POST parameters</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">POST parameter number exceeds allowed maximum.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">POST parameter name length</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">POST parameter name exceeds allowed maximum length.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">POST parameter value length</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">POST parameter value exceeds allowed maximum length.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">POST parameter combined length</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Combined length of POST parameter name and value exceeds allowed maximum length.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Generic protocol violation</span></b>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">Protocol violations like missing content length or content type headers for POST requests.</td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">General request violation</span></b>
                                                        </td>
                                                        <td align="left">Other generic violations.</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div>
                                            <div>
                                                <h3 id="Requestparsing" data-magellan-target="Requestparsing">Request parsing
<a name="ref_services_policy_operating_mode.htm#mode_request_parsing"></a></h3>
                                            </div>
                                        </div>
                                        <p>For <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> to parse requests as close as possible to the way the target application/web server technology does,
 it is important to configure web application behavior.
            </p>
                                        <div class="sect4" title="1.2.2.1.&#160;Delimiters">
                                            <div class="titlepage">
                                                <div>
                                                    <div>
                                                        <h4 id="Delimiters" data-magellan-target="Delimiters"><a name="ref_web_application_behaviour_delimiters"></a>Delimiters
                        </h4>
                                                    </div>
                                                </div>
                                            </div>
                                            <p>According to the official RFC, query part of a URL is delimited by ? and parameter part by &amp;. Some web applications do not
 honor this delimiter and use different delimiters. Possible delimiters are: ";?:@&amp;+$,". Several delimiters are separated by a space.
               </p>
                                            <p>You cannot reuse a delimiter characters across the three delimiter categories.</p>
                                            <div class="informaltable">
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                    <colgroup>
                                                        <col width="25%" align="left">
                                                        </col>
                                                        <col width="75%" align="left">
                                                        </col>
                                                    </colgroup>
                                                    <tbody>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Query delimiter(s)</span></b>
                                                                <p>Input field</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Characters used for delimiting query part of the URL.</p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>Characters: <code class="literal">;?:@&amp;+$,</code></p>
                                                                            <p>Several delimiters are separated by a space.</p>
                                                                        </dd>
                                                                        <dt><span class="term">Input example</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">?</code> - /somepage.jsp<span class="bold"><strong>?</strong></span>par1=val1&amp;par2=val2
                                       </p>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">?</code>
                                                                            </p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Parameter delimiter(s)</span></b>
                                                                <p>Input field</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Characters used for delimiting parameters in the URL.</p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>Characters: <code class="literal">;?:@&amp;+$,</code></p>
                                                                            <p>Several delimiters are separated by a space.</p>
                                                                        </dd>
                                                                        <dt><span class="term">Input example</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">&amp;</code> - /somepage.jsp?par1=val1<span class="bold"><strong>&amp;</strong></span>par2=val2
                                       </p>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">&amp;</code>
                                                                            </p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">URL session id delimiter(s)</span></b>
                                                                <p>Input field</p>
                                                            </td>
                                                            <td align="left">
                                                                <p>Characters used for delimiting URL based session identfiiers from the rest of the query.</p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>Characters: <code class="literal">;?:@&amp;+$,</code></p>
                                                                            <p>Several delimiters are separated by a space.</p>
                                                                        </dd>
                                                                        <dt><span class="term">Input example</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">;</code> - /somepage.jsp<span class="bold"><strong>;</strong></span>jsessionid=longidstring?par1=val1&amp;par2=val2
                                       </p>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">;</code>
                                                                            </p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div class="caution">
                                                <p>Do not change these delimiters unless you are absolutely certain that you know the consequences.</p>
                                            </div>
                                        </div>
                                        <div class="sect4" title="1.2.2.2.&#160;Response encoding">
                                            <div class="titlepage">
                                                <div>
                                                    <div>
                                                        <h4 id="Responseencoding" data-magellan-target="Responseencoding"><a name="ref_web_application_behaviour_charset"></a>Response encoding
                        </h4>
                                                    </div>
                                                </div>
                                            </div>
                                            <p>When output rewriting or CSRF protection is enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> must know the character set for
 the pages served by the web application/server to rewrite pages correctly. <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> tries to read
 the character set in use from the Content-Type header in the web server response. However, if the header does not specify
 a character set <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> defaults to the configured charset.
               </p>
                                            <div class="informaltable">
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                    <colgroup>
                                                        <col width="25%" align="left">
                                                        </col>
                                                        <col width="75%" align="left">
                                                        </col>
                                                    </colgroup>
                                                    <tbody>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Response charset default</span></b>
                                                                <p>Input field</p>
                                                            </td>
                                                            <td align="left">
                                                                <p>Default character set used for encoding served pages if none specified by backend server.</p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>Character set as defined in the response server header Content-Type or in the META tag content-type in the response body of
 pages served by the backend web server.
                                       </p>
                                                                            <p>Examples:</p>
                                                                            <p>Meta tag: &lt;meta http-equiv="content-type" content="text/html; charset=UTF-8"&gt; - UTF-8</p>
                                                                            <p>Header: Content-Type: text/html; charset=iso-8859-1 - iso-8859-1</p>
                                                                        </dd>
                                                                        <dt><span class="term">Input example</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">utf8</code>
                                                                            </p>
                                                                            <p><code class="literal">iso-8859-1</code>
                                                                            </p>
                                                                            <p><code class="literal">shift_jis</code>
                                                                            </p>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">utf8</code>
                                                                            </p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="sect4" title="1.2.2.3.&#160;Content type - POST requests">
                                            <div class="titlepage">
                                                <div>
                                                    <div>
                                                        <h4 id="ContenttypePOSTrequests" data-magellan-target="ContenttypePOSTrequests"><a name="ref_web_application_behaviour_case"></a>Content type - POST requests
                        </h4>
                                                    </div>
                                                </div>
                                            </div>
                                            <p>These options are all related to parsing and validation of POST requests.</p>
                                            <div class="informaltable">
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                    <colgroup>
                                                        <col width="25%" align="left">
                                                        </col>
                                                        <col width="75%" align="left">
                                                        </col>
                                                    </colgroup>
                                                    <tbody>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Guess Content-Type</span></b>
                                                                <p>Check box</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Inspect payload of POST requests to guess content type if Content-Type header not present.</p>
                                                                <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Validate multipart/form-data request format</span></b>
                                                                <p>Check box</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>When parsing, multipart form data requires that the payload is formatted correctly.</p>
                                                                <p>If enabled, requests that does not validate correctly will be denied.</p>
                                                                <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Block on multipart/form-data request parsing errors</span></b>
                                                                <p>Check box</p>
                                                            </td>
                                                            <td align="left">
                                                                <p>When parsing, multipart form data blocks recoverable request parsing errors like missing data caused by content-length being
 too small.
                              </p>
                                                                <p>If enabled, requests that that does not parse correctly are blocked.</p>
                                                                <p>It is highly recommended that this setting is enabled as disabling it introduces the risk of attacks bypassing the <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> filter.</p>
                                                                <p>Default: <code class="literal">&lt;enabled&gt;</code></p>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="sect4" title="1.2.2.4.&#160;Case sensitivity">
                                            <div class="titlepage">
                                                <div>
                                                    <div>
                                                        <h4 id="Casesensitivity" data-magellan-target="Casesensitivity"><a name="ref_web_application_behaviour_case.hx4fv"></a>Case sensitivity
                        </h4>
                                                    </div>
                                                </div>
                                            </div>
                                            <p>Some web systems match requests case sensitive and some do not. When web systems are not case sensitive it is not uncommon
 that samples of requests are presented in different case combinations.
               </p>
                                            <p>To avoid requests to resources with different case being learned as different requests, case sensitivity can be disabled.</p>
                                            <div class="informaltable">
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                    <colgroup>
                                                        <col width="25%" align="left">
                                                        </col>
                                                        <col width="75%" align="left">
                                                        </col>
                                                    </colgroup>
                                                    <tbody>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Enable case sensitivity</span></b>
                                                                <p>Check box</p>
                                                            </td>
                                                            <td align="left">
                                                                <p>Enable / disable case sensitivity matching.</p>
                                                                <p>Some web systems match requests case sensitive and some do not. When web systems are not case sensitive it is not uncommon
 that samples of requests are presented in different case combinations.
                              </p>
                                                                <p>If enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will match case sensitive.</p>
                                                                <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="sect4" title="1.2.2.5.&#160;Request header re-writing">
                                            <div class="titlepage">
                                                <div>
                                                    <div>
                                                        <h4 id="Requestheaderrewriting" data-magellan-target="Requestheaderrewriting"><a name="d0e6788"></a>Request header re-writing
                        </h4>
                                                    </div>
                                                </div>
                                            </div>
                                            <p><span class="mc-variable ALVariables.WAF_2 variable">WAF</span> allows for re-writing arbitrary request header values using regular expressions for matching the value
 to re-write.
               </p>
                                            <div class="informaltable">
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                    <colgroup>
                                                        <col width="25%" align="left">
                                                        </col>
                                                        <col width="75%" align="left">
                                                        </col>
                                                    </colgroup>
                                                    <tbody>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable header re-writing</span></b>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Select or clear the check box <b><span class="guilabel">Enable request header re-writing</span></b> to enable this feature.
                              </p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Rewriting rules</span></b>
                                                            </td>
                                                            <td align="left">
                                                                <p>In the input area enter one or more rules for header rewriting. </p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>A triplet in the format: <code class="literal">Header_field::match_regular_expression::subst_value</code>.
                                       </p>
                                                                            <p><code class="literal">match_regular_expression</code> is a regular expression matching the substring in the header value to replace with <code class="literal">subst_value</code>.
                                       </p>
                                                                            <p>Escape meta characters (<code class="literal">.*+?()[]-|^$\</code>) with <code class="literal">\</code> to match literally.
                                       </p>
                                                                        </dd>
                                                                        <dt><span class="term">Input examples</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <div class="variablelist">
                                                                                <dl>
                                                                                    <dt><span class="term">Rewriting Referer field value</span>
                                                                                    </dt>
                                                                                    <dd>
                                                                                        <p>substitute https with http</p>
                                                                                        <p>Referer::^https::http</p>
                                                                                    </dd>
                                                                                    <dt><span class="term">Rewriting X-Forwarded-For ip address</span>
                                                                                    </dt>
                                                                                    <dd>
                                                                                        <p>X-Forwarded-For::10\.10\.10\.10::192.168.0.11</p>
                                                                                    </dd>
                                                                                </dl>
                                                                            </div>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">none</code>
                                                                            </p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="titlepage">
                                            <div>
                                                <div>
                                                    <h3 id="Attackclasscriticality" data-magellan-target="Attackclasscriticality">Attack class criticality
<a name="ref_services_policy_operating_mode.htm#mode_criticality"></a></h3>
                                                </div>
                                            </div>
                                        </div>
                                        <p>For each attack class in the list define the criticality level.</p>
                                        <div class="informaltable">
                                            <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                <colgroup>
                                                    <col width="25%" align="left">
                                                    </col>
                                                    <col width="75%" align="left">
                                                    </col>
                                                </colgroup>
                                                <tbody>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Attack class</span></b>
                                                            <ul>
                                                                <li>Drop-down lists: SQL injection</li>
                                                                <li> XPath injection</li>
                                                                <li>SSI injection </li>
                                                                <li>OS commanding</li>
                                                                <li> XSSPath traversal </li>
                                                                <li>Enumeration</li>
                                                                <li> Format string</li>
                                                                <li>
 Buffer overflow</li>
                                                                <li>DoS attempt</li>
                                                                <li> Worm probe, and more<![CDATA[                           ]]></li>
                                                            </ul>
                                                        </td>
                                                        <td align="left">
                                                            <p>Select a criticality level for the attack class.</p>
                                                            <div class="variablelist">
                                                                <dl>
                                                                    <dt><span class="term">Valid input</span>
                                                                    </dt>
                                                                    <dd>
                                                                        <p>Options from the drop-down list:</p>
                                                                        <div class="itemizedlist">
                                                                            <ul class="itemizedlist" type="disc">
                                                                                <li class="listitem">
                                                                                    <p><code class="literal">Critical</code>
                                                                                    </p>
                                                                                </li>
                                                                                <li class="listitem">
                                                                                    <p><code class="literal">High</code>
                                                                                    </p>
                                                                                </li>
                                                                                <li class="listitem">
                                                                                    <p><code class="literal">Medium</code>
                                                                                    </p>
                                                                                </li>
                                                                                <li class="listitem">
                                                                                    <p><code class="literal">Low</code>
                                                                                    </p>
                                                                                </li>
                                                                                <li class="listitem">
                                                                                    <p><code class="literal">None</code>
                                                                                    </p>
                                                                                </li>
                                                                            </ul>
                                                                        </div>
                                                                    </dd>
                                                                    <dt><span class="term">Default value</span>
                                                                    </dt>
                                                                    <dd>
                                                                        <p>Attack class dependent.</p>
                                                                    </dd>
                                                                </dl>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div>
                                            <h3 id="SourceIPtrackingandblocking" data-magellan-target="SourceIPtrackingandblocking">Source IP tracking and blocking
<a name="ref_services_policy_operating_mode.htm#mode_ip_tracking"></a></h3>
                                        </div>
                                        <p>Source IP tracking and blocking adds IP sources exceeding a certain risk level to summary database. This allows for tracking
 attacker activity across the websites configured in <span class="mc-variable ALVariables.WAF_2 variable">WAF</span>. The <a lang="" class="link" href="ch_dashboards.htm#ref_dashboards_deny_log.htm" title="1.2.&#160;Interactive list" alt="1.2.&#160;Interactive list">Dashboard Deny Log Interactive List</a> and the global <a class="link" href="ref_services_network.htm#ref_services_network_attack_source_auto_blocking.htm" title="2.4.&#160;Attack source Auto blocking" alt="2.4.&#160;Attack source Auto blocking">Attack Source Auto Blocking</a> are both based on the information collected when this feature is enabled.
            </p>
                                        <div>
                                            <h5 class="title"><a name="d0e6934"></a>Track violating IPs across websites
                        </h5>
                                        </div>
                                        <div class="informaltable">
                                            <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                <colgroup>
                                                    <col width="25%" align="left">
                                                    </col>
                                                    <col width="75%" align="left">
                                                    </col>
                                                </colgroup>
                                                <tbody>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable IP source tracking</span></b>
                                                            <p>Check box</p>
                                                        </td>
                                                        <td style="border-bottom: 0.5pt solid;" align="left">
                                                            <p>Enable / disable IP source tracking.</p>
                                                            <p>Tracked IPs will feed into the blacklisting controls and, if enabled, IPs exceeding limits will be blocked.</p>
                                                            <p>Default: <code class="literal">&lt;enabled&gt;</code></p>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Risk level</span></b>
                                                            <p>Drop-down list</p>
                                                        </td>
                                                        <td align="left">
                                                            <p>Sets the risk level above which the source IP is tracked and added to the global database.</p>
                                                            <div class="variablelist">
                                                                <dl>
                                                                    <dt><span class="term">Valid input</span>
                                                                    </dt>
                                                                    <dd>
                                                                        <p>Options from the drop-down list</p>
                                                                        <p><code class="literal">Critical</code>, <code class="literal">High</code>, <code class="literal">Medium</code>, <code class="literal">Low</code>, <code class="literal">None</code></p>
                                                                    </dd>
                                                                    <dt><span class="term">Default value</span>
                                                                    </dt>
                                                                    <dd>
                                                                        <p><code class="literal">&lt;High&gt;</code>
                                                                        </p>
                                                                    </dd>
                                                                </dl>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="sect4" title="1.2.4.2.&#160;Immediate blacklisting">
                                            <div class="titlepage">
                                                <div>
                                                    <div>
                                                        <h4 id="Immediateblacklisting" data-magellan-target="Immediateblacklisting">Immediate blacklisting
<a name="d0e6997"></a></h4>
                                                    </div>
                                                </div>
                                            </div>
                                            <p>When a request is denied at the application level, instead of just stopping the request the source IP can be blacklisted forcing
 the attacker to change IP address or to find another target.
               </p>
                                            <div class="informaltable">
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                    <colgroup>
                                                        <col width="25%" align="left">
                                                        </col>
                                                        <col width="75%" align="left">
                                                        </col>
                                                    </colgroup>
                                                    <tbody>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel"> Enable IP source immediate blocking</span></b>
                                                                <p>Check box</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Enable / disable IP source immediate blocking.</p>
                                                                <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Risk level</span></b>
                                                                <p>Drop-down list</p>
                                                            </td>
                                                            <td align="left">
                                                                <p>Sets the risk level above which the source IP is immediately blocked.</p>
                                                                <p>When the IP is blocked, the attacker will not be able to access the website from that source IP for a duration configured in
                                 <a class="link" href="ref_services_network.htm#ref_services_network_attack_source_auto_blocking.htm" title="2.4.&#160;Attack source Auto blocking" alt="2.4.&#160;Attack source Auto blocking">Attack source auto blocking</a>.
                              </p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>Options from the drop-down list</p>
                                                                            <p><code class="literal">Critical</code>, <code class="literal">High</code>, <code class="literal">Medium</code>, <code class="literal">Low</code>, <code class="literal">None</code></p>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">&lt;High&gt;</code>
                                                                            </p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="sect4" title="1.2.4.3.&#160;Layer 7 source IP blocking">
                                            <div class="titlepage">
                                                <div>
                                                    <div>
                                                        <h4 id="Layer7sourceIPblocking" data-magellan-target="Layer7sourceIPblocking">Layer 7 source IP blocking
<a name="d0e7065"></a></h4>
                                                    </div>
                                                </div>
                                            </div>
                                            <p>If application layer source IP blocking is enabled, when running behind a layer 7 proxy that otherwise would hide the client
 source IP, client source IPs are extracted from the X-Forwarded-For header and source IP based blocking controls are enforced
 at layer 7 instead of at the network layer.
               </p>
                                            <div class="informaltable">
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                    <colgroup>
                                                        <col width="25%" align="left">
                                                        </col>
                                                        <col width="75%" align="left">
                                                        </col>
                                                    </colgroup>
                                                    <tbody>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Layer 7 source IP blocking</span></b>
                                                                <p>Check box</p>
                                                            </td>
                                                            <td align="left">
                                                                <p>Enable / disable Layer 7 source IP blocking.</p>
                                                                <p>Note that this feature has to be enabled at the global level. If this is not the case, this will be indicated in the field
 label.
                                 </p>
                                                                <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <h4 id="GeolocationIPaccesscontrol" data-magellan-target="GeolocationIPaccesscontrol">Geolocation IP access control</h4>
                                        <p>Geo IP blocking restricts access to your website from certain regions based on the geographic location of the incoming request. The <span class="mc-variable ALVariables.WAF_1 variable">Alert Logic Managed Web Application Firewall (WAF)</span> product checks incoming IP addresses against a blacklist or whitelist account, and determines whether to approve or deny access to the request. You can configure which countries you want <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> to block. </p>
                                        <div class="informaltable">
                                            <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                <colgroup>
                                                    <col width="100px" align="left">
                                                    </col>
                                                    <col width="75%" align="left">
                                                    </col>
                                                </colgroup>
                                                <tbody>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;" align="left"><b>Enable GeoIP access control</b>
                                                            <p>Check box</p>
                                                        </td>
                                                        <td align="left">
                                                            <li>Select the country you want to either blacklist or whitelist. You can also select more than one country.</li>
                                                            <p>                                 Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="border-right: 0.5pt solid;" align="left">
                                                            <p align="left">Select </p>
                                                            <p align="left"><b>Whitelist</b> </p>
                                                            <p align="left">or </p>
                                                            <p align="left"><b>Blacklist</b>
                                                            </p>
                                                        </td>
                                                        <td align="left">Whitelist or Blacklist the countries you added.</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="note">
                                            <p>Single-clicking  will deselect all other countries if you previously had other countries selected. You must select the countries you previously had selected again, and any new ones you want to add. 
To select more than one country, click and hold the control key on your keyboard as you click to select countries.</p>
                                        </div>
                                        <div class="sect3" title="1.2.5.&#160;External notification">
                                            <div class="titlepage">
                                                <div>
                                                    <div>
                                                        <h3 id="Externalnotification" data-magellan-target="Externalnotification">External notification
<a name="ref_services_policy_operating_mode.htm#mode_alerting"></a></h3>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="sect4" title="1.2.5.1.&#160;Alerts and summary">
                                                <div class="titlepage">
                                                    <div>
                                                        <div>
                                                            <h4 id="Alertsandsummary" data-magellan-target="Alertsandsummary"><a name="d0e7095"></a>Alerts and summary
                        </h4>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="sect5" title="1.2.5.1.1.&#160;Syslog alerts">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h4 id="Syslogalerts" data-magellan-target="Syslogalerts"><a name="d0e7098"></a>Syslog alerts
                           </h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>Enable sending of alerts to syslog server. Only alerts with priority above or equal to the configured threshold are sent.
 Alerts are sent to <code class="literal">Local3</code> facility.
                  </p>
                                                    <p>To have attack alerts sent to an external syslog server configure threshold level and server address in <b><span class="guiicon">System</span></b>-&gt;<b><span class="guimenuitem">Configuration</span></b>.
                  </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left">
                                                                </col>
                                                                <col width="75%" align="left">
                                                                </col>
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Enable alerts to syslog</span></b>
                                                                        <p>Check box + Drop-down list</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Enable or disable sending of alerts to syslog server.</p>
                                                                        <p>When enabled, the drop-down menu <b><span class="guilabel">Syslog criticality threshold</span></b> specifies the lowest informational level (priority) for which alerts will be sent to the syslog server.
                                 </p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Valid input</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>Options from the drop-down list:</p>
                                                                                    <div class="itemizedlist">
                                                                                        <ul class="itemizedlist" type="disc">
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">LOG_CRIT</code>
                                                                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">LOG_ERR</code>
                                                                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">LOG_WARNING</code>
                                                                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">LOG_NOTICE</code>
                                                                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">LOG_INFO</code>
                                                                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">LOG_DEBUG</code>
                                                                                                </p>
                                                                                            </li>
                                                                                        </ul>
                                                                                    </div>
                                                                                </dd>
                                                                                <dt><span class="term">Default value</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">Disabled - LOG_WARNING</code>
                                                                                    </p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="sect5" title="1.2.5.1.2.&#160;Email alerts">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h4 id="Emailalerts" data-magellan-target="Emailalerts"><a name="d0e7173"></a>Email alerts
                           </h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>Enable sending of alerts by email. Only alerts with priority above or equal to the configured threshold are sent.</p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left">
                                                                </col>
                                                                <col width="75%" align="left">
                                                                </col>
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Enable email alerts</span></b>
                                                                        <p>Check box + Drop-down list</p>
                                                                    </td>
                                                                    <td align="left">
                                                                        <p>Enable or disable sending of email alerts.</p>
                                                                        <p>When enabled, the drop-down menu <b><span class="guilabel">Instant email criticality threshold</span></b> specifies the lowest informational level (priority) for which alerts will be sent.
                                 </p>
                                                                        <div class="variablelist">
                                                                            <dl>
                                                                                <dt><span class="term">Valid input</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p>Options from the drop-down list:</p>
                                                                                    <div class="itemizedlist">
                                                                                        <ul class="itemizedlist" type="disc">
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">LOG_CRIT</code>
                                                                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">LOG_ERR</code>
                                                                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">LOG_WARNING</code>
                                                                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">LOG_NOTICE</code>
                                                                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">LOG_INFO</code>
                                                                                                </p>
                                                                                            </li>
                                                                                            <li class="listitem">
                                                                                                <p><code class="literal">LOG_DEBUG</code>
                                                                                                </p>
                                                                                            </li>
                                                                                        </ul>
                                                                                    </div>
                                                                                </dd>
                                                                                <dt><span class="term">Default value</span>
                                                                                </dt>
                                                                                <dd>
                                                                                    <p><code class="literal">Enabled - LOG_ERR</code>
                                                                                    </p>
                                                                                </dd>
                                                                            </dl>
                                                                        </div>
                                                                        <p>The email address is the contact email specified in <b><span class="guiicon">System</span></b>-&gt;<b><span class="guimenuitem">Configuration</span></b>.
                                 </p>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="sect4" title="1.2.5.2.&#160;Attack class criticality to log priority mapping">
                                                <div class="titlepage">
                                                    <div>
                                                        <div>
                                                            <h4 id="Attackclasscriticalitytologprioritymapping" data-magellan-target="Attackclasscriticalitytologprioritymapping"><a name="d0e7245"></a>Attack class criticality to log priority mapping
                        </h4>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p>For each criticality level set the corresponding log priority (informational level).</p>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left">
                                                            </col>
                                                            <col width="443px" align="left">
                                                            </col>
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Criticality level</span></b>
                                                                    <p>Drop-down lists (Critical, High, Medium, Low, None)</p>
                                                                </td>
                                                                <td align="left">
                                                                    <p>Select a log priority level for each criticality level.</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>Options from the drop-down list:</p>
                                                                                <div class="itemizedlist">
                                                                                    <ul class="itemizedlist" type="disc">
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal">LOG_ALERT</code>
                                                                                            </p>
                                                                                        </li>
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal">LOG_CRIT</code>
                                                                                            </p>
                                                                                        </li>
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal">LOG_ERR</code>
                                                                                            </p>
                                                                                        </li>
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal">LOG_WARNING</code>
                                                                                            </p>
                                                                                        </li>
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal">LOG_NOTICE</code>
                                                                                            </p>
                                                                                        </li>
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal">LOG_INFO</code>
                                                                                            </p>
                                                                                        </li>
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal">LOG_DEBUG</code>
                                                                                            </p>
                                                                                        </li>
                                                                                    </ul>
                                                                                </div>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <div class="itemizedlist">
                                                                                    <ul class="itemizedlist" type="disc">
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal">Critical -&gt; LOG_CRIT</code>
                                                                                            </p>
                                                                                        </li>
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal">High -&gt; LOG_ERROR</code>
                                                                                            </p>
                                                                                        </li>
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal">Medium -&gt; LOG_WARNING</code>
                                                                                            </p>
                                                                                        </li>
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal">Low -&gt; LOG_NOTICE</code>
                                                                                            </p>
                                                                                        </li>
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal">None -&gt; LOG_INFO</code>
                                                                                            </p>
                                                                                        </li>
                                                                                    </ul>
                                                                                </div>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="sect3" title="1.2.6.&#160;Deny log settings">
                                            <div>
                                                <h3 id="Denylogsettings" data-magellan-target="Denylogsettings">Deny log settings
<a name="ref_services_policy_operating_mode.htm#mode_deny_log"></a></h3>
                                            </div>
                                            <div class="sect4" title="1.2.6.1.&#160;Policy violations">
                                                <div>
                                                    <h4 id="Policyviolations" data-magellan-target="Policyviolations"><a name="d0e7329"></a>Policy violations
                        </h4>
                                                </div>
                                                <p>Enable/disabled support for logging of blocked requests.</p>
                                                <p>When a request fails the defined access policy for a given proxy, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will block the request.</p>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="125px" align="left">
                                                            </col>
                                                            <col width="75%" align="left">
                                                            </col>
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable logging for normal/filtered requests</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Enable / disable logging for normal/filtered requests.</p>
                                                                    <p>If enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will log blocked requests for normal/filtered end-user traffic.</p>
                                                                    <p>Default: <code class="literal">&lt;enabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                            <tr data-mc-conditions="Primary.NOTinBHOOF">
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable logging for pass-through requests (IP whitelisted)</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Enable / disable logging for pass-through requests (Pass through mode)</p>
                                                                    <p>If enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will log blocked requests from client matching the pass-through white-list.</p>
                                                                    <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Do not log bypassed requests from trusted clients</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Disable logging of bypassed requests (that would have been blocked) from trusted clients.</p>
                                                                    <p>If selected, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will not log requests that are violating the policy but are bypassed because the
 source IP is in the trusted clients list of the website proxy and HTTP blocking bypass is enabled for trusted clients.
                              </p>
                                                                    <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Do not log blocked requests from trusted clients</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td align="left">
                                                                    <p>Disable logging of blocked requests from trusted clients.</p>
                                                                    <p>If checked, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will not log requests that get blocked if the source IP is in the trusted clients list of
 the website proxy.
                              </p>
                                                                    <p>It is not recommended to disable logging of blocked requests unless there is a good reason for it. If for example some kind
 of monitoring software is used to regularly verify that specific requests are being blocked it could be desirable not to have
 these requests logged in order to prevent the log from being filled with these (known) requests.
                              </p>
                                                                    <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                            <tr data-mc-conditions="Primary.beta">
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Do not log GeoIP violations</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td align="left">
                                                                    <p align="left">Supported optional silencing of GeoIP access violations</p>
                                                                    <p align="left">If checked, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will  silence GeoIP access violations and not log them</p>
                                                                    <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="sect4" title="1.2.6.2.&#160;Broken requests">
                                                <div>
                                                    <h4 id="Brokenrequests" data-magellan-target="Brokenrequests"><a name="d0e7407"></a>Broken requests
                        </h4>
                                                </div>
                                                <p>Enable/disable logging of broken requests.</p>
                                                <p>Broken requests are either requests resulting from broken internal or external links. Broken bot requests are requests originating
 from bots not adhering to standards.
               </p>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left">
                                                            </col>
                                                            <col width="75%" align="left">
                                                            </col>
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable logging of broken links</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Enable / disable logging of referred requests (requests with a referrer header) allowed by the policy but resulting in a <code class="literal">404 not found</code> error from the web server.
                              </p>
                                                                    <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable logging of webserver 404 not found</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Enable / disable logging of requests allowed by the policy but resulting in a <code class="literal">404 not found</code> error from the web server.
                              </p>
                                                                    <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Enable logging of broken bot requests</span></b>
                                                                    <p>Check box</p>
                                                                </td>
                                                                <td align="left">
                                                                    <p>Enable / disable logging of requests classified as broken bot requests.</p>
                                                                    <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="sect4" title="1.2.6.3.&#160;Log data masking">
                                                <div>
                                                    <h4 id="Logdatamasking" data-magellan-target="Logdatamasking"><a name="d0e7467"></a>Log data masking
                        </h4>
                                                </div>
                                                <p>In order to avoid compromising confidential data like for instance payment card numbers (along with other payment card data
 like control code and expiration date) ending up in the deny log it is possible to configure log data masking policies based
 on regular expressions.
               </p>
                                                <div class="informaltable">
                                                    <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                        <colgroup>
                                                            <col width="25%" align="left">
                                                            </col>
                                                            <col width="75%" align="left">
                                                            </col>
                                                        </colgroup>
                                                        <tbody>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable rewriting of logged querys</span></b>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>Select or clear the check box <b><span class="guilabel">Enable rewriting of logged querys</span></b> to enable this feature.
                              </p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Name</span></b>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>This is an informal field allowing for assigning a human readable name to the rewrite policy rule.</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>Any text string</p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <div class="itemizedlist">
                                                                                    <ul class="itemizedlist" type="disc">
                                                                                        <li class="listitem">
                                                                                            <p>Payment Card</p>
                                                                                        </li>
                                                                                        <li class="listitem">
                                                                                            <p>SSN</p>
                                                                                        </li>
                                                                                    </ul>
                                                                                </div>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">Payment card</code>
                                                                                </p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Search for</span></b>
                                                                </td>
                                                                <td style="border-bottom: 0.5pt solid;" align="left">
                                                                    <p>A regular expression matching the string to replace.</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>A regular expression.</p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <div class="itemizedlist">
                                                                                    <ul class="itemizedlist" type="disc">
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal"><code class="literal">(?:\d{4}[\-\x20]?){2}\d{4,5}[\-\x20]?(?:\d{2,4})?</code></code> - matches most payment card numbers
                                                </p>
                                                                                        </li>
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal"><code class="literal">\d{3}-\d{2}-\d{4}</code></code> - matches US Social Security Number strings, no validation of the value.
                                                </p>
                                                                                        </li>
                                                                                    </ul>
                                                                                </div>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">(?:\d{4}[\-\x20]?){2}\d{4,5}[\-\x20]?(?:\d{2,4})?</code>
                                                                                </p>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                    <p>Notice the use of backslash ("\") in the examples above to escape the metacharacter ".". Without escaping the "." it will
 be interpreted as a metacharacter matching any character resulting in the regular expression also matching strings like xxxyhost2xxx4tld
 and xxxhost_xxx_tld (a.o.).
                              </p>
                                                                    <p>The regular expressions matches case insensitive in a repetitive fashion meaning that if more than one instance of the search
 pattern is present in the string they will all be replaced.
                              </p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Replace with</span></b>
                                                                </td>
                                                                <td align="left">
                                                                    <p>A string to replace with</p>
                                                                    <div class="variablelist">
                                                                        <dl>
                                                                            <dt><span class="term">Valid input</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p>Any text string gramatically equal to the data being matched but with no semantic meaning (in order to mask the information
 in the string being matched).
                                       </p>
                                                                            </dd>
                                                                            <dt><span class="term">Input example</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <div class="itemizedlist">
                                                                                    <ul class="itemizedlist" type="disc">
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal"><code class="literal">9999-9999-9999-9999</code></code>
                                                                                            </p>
                                                                                        </li>
                                                                                        <li class="listitem">
                                                                                            <p><code class="literal">999-99-9999</code>
                                                                                            </p>
                                                                                        </li>
                                                                                    </ul>
                                                                                </div>
                                                                            </dd>
                                                                            <dt><span class="term">Default value</span>
                                                                            </dt>
                                                                            <dd>
                                                                                <p><code class="literal">9999-9999-9999-9999</code>
                                                                                </p>
                                                                                <div class="note">
                                                                                    <p>The log data input policy rules rewrites all data being handled by the website proxy log subsystem. This includes data for
 the Learner. Therefore <span class="bold"><strong>do not</strong></span> rewrite a payment card number to something like MASKED_PAN as this will result in the Learner wrongfully selecting the class
 alphanum for payment card input which will not match payment card numbers with "-" (dash) or " " (space) in. Instead rewrite
 to something similar like in the examples above.
</p>
                                                                                </div>
                                                                            </dd>
                                                                        </dl>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <div class="note">
                                                    <p>The default rule that matches most standard credit card numbers is always on in order to reduce the risk of payment card from
 inadvertently being transmitted to the Alert Logic backend with deny log information.
                           </p>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                            <div>
                                                <div>
                                                    <h3 id="Accesslogsettings" data-magellan-target="Accesslogsettings"><a name="mode_access_log"></a>Access log settings
                     </h3>
                                                </div>
                                            </div>
                                            <p>When <span class="emphasis"><em>access logging</em></span> is enabled all requests to the website is logged.
            </p>
                                            <p>The access log is generated on a per day basis and closed logs are made available for download.</p>
                                            <div class="informaltable">
                                                <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                    <colgroup>
                                                        <col width="25%" align="left" />
                                                        <col width="75%" align="left" />
                                                    </colgroup>
                                                    <tbody>
                                                        <tr data-mc-conditions="Primary.Draft Content">
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Enable access logging</span></b>
                                                                <p>Check box</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Enable / disable access logging.</p>
                                                                <p>If enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will log all proxied requests to the web site.</p>
                                                                <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Access log format</span></b>
                                                                <p>Drop-down list</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Select the format for the access log.</p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>Options from the drop-down list</p>
                                                                            <p><code class="literal">Web Application Firewall Common</code>, <code class="literal">Common Log Format</code>, <code class="literal">Common Log Format with Virtual Host</code>, <code class="literal">NCSA extended/combined</code>, <code class="literal">Custom</code></p>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">&lt;Web Security Manager Common&gt;</code>
                                                                            </p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                                <p>When the <code class="literal">Custom</code> is selected, the input field below the drop-down becomes active and allows for specifying a custom log format.
                           </p>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Custom format</span></b>
                                                                <p>Input field</p>
                                                            </td>
                                                            <td style="border-bottom: 0.5pt solid;" align="left">
                                                                <p>Define a custom log format.</p>
                                                                <div class="variablelist">
                                                                    <dl>
                                                                        <dt><span class="term">Valid input</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p>A sequence of the input fields below separated by space.</p>
                                                                        </dd>
                                                                        <dt><span class="term">Input example</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">remote_addr time_local request status body_bytes_sent referer</code>
                                                                            </p>
                                                                        </dd>
                                                                        <dt><span class="term">Default value</span>
                                                                        </dt>
                                                                        <dd>
                                                                            <p><code class="literal">remote_addr remote_logname remote_user time_local request status body_bytes_sent referer user_agent cookie roundtrip</code>
                                                                            </p>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Add roundtrip time and cache info to access log format</span></b>
                                                                <p>Check box</p>
                                                            </td>
                                                            <td align="left">
                                                                <p>Enable / disable additional proxy specific log fields.</p>
                                                                <p>If enabled, <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> will add roundtrip time and "served from cache flag" to the selected log format. </p>
                                                                <p>Default: <code class="literal">&lt;disabled&gt;</code></p>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div class="sect4" title="1.2.7.1.&#160;Getting/viewing the access log files">
                                                <div class="titlepage">
                                                    <div>
                                                        <div>
                                                            <h4 id="Gettingviewingtheaccesslogfiles" data-magellan-target="Gettingviewingtheaccesslogfiles"><a name="d0e7734"></a>Getting/viewing the access log files
                        </h4>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p>When log files are available for download, the file name is an active link. To download an access log file click on the file name.</p>
                                                <p>When remote backup is enabled, the latest access log file made available for download will be compressed (using gzip) and
 copied to the remote backup destination along with the backup of the system configuration.
               </p>
                                            </div>
                                            <div class="sect4" title="1.2.7.2.&#160;Access log formats">
                                                <div class="titlepage">
                                                    <div>
                                                        <div>
                                                            <h4 id="Accesslogformats" data-magellan-target="Accesslogformats"><a name="ref_access_log_formats"></a>Access log formats
                        </h4>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p><span class="mc-variable ALVariables.WAF_2 variable">WAF</span> supports a number of standard access log formats suitable for importing into log-analysis tools. For
 plain access logging the <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> format is the most condensed.
               </p>
                                                <div class="sect5" title="1.2.7.2.1.&#160;Web Security Manager Common">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h4 id="AlertLogicManagedWebApplicationFirewallWAFCommon" data-magellan-target="AlertLogicManagedWebApplicationFirewallWAFCommon"><a name="d0e7746"></a><span class="mc-variable ALVariables.WAF_1 variable">Alert Logic Managed Web Application Firewall (WAF)</span> Common
                           </h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>The <span class="mc-variable ALVariables.WAF_2 variable">WAF</span> Common log format is a condensed version of the Common log format (below). It contains only basic
 HTTP access information and the time field is kept in Unix epoch format to save time and space.
                  </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Source IP</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">The client source IP address.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Time</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Time the request was received (UNIX timestamp)</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Request</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">First line of request</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Server response code</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Web server server response code - i.e. <code class="literal">200</code></td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Response size</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Size of response in bytes, excluding HTTP headers</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Response time</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">The time taken to serve the request, in microseconds</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Cached response</span></b>
                                                                    </td>
                                                                    <td align="left">Is response served from cache or not (1=yes, 0=no)</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="sect5" title="1.2.7.2.2.&#160;Common Log Format">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h4 id="CommonLogFormat" data-magellan-target="CommonLogFormat"><a name="d0e7800"></a>&#160;Common Log Format
                           </h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>The Common log format contains only basic HTTP access information.</p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Source IP</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">The client source IP address.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Remote logname</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">N/A - will contain a dash, included for compatibility.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Remote user</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">N/A - will contain a dash, included for compatibility.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Time</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Time the request was received (standard english format)</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Request</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">First line of request</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Server response code</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Web server server response code - i.e. <code class="literal">200</code></td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Response size</span></b>
                                                                    </td>
                                                                    <td align="left">Size of response in bytes, excluding HTTP headers. In CLF format, i.e. a '-' rather than a 0 when no bytes are sent.</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="sect5" title="1.2.7.2.3.&#160;Common Log Format with Virtual Host">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h4 id="CommonLogFormatwithVirtualHost" data-magellan-target="CommonLogFormatwithVirtualHost"><a name="d0e7854"></a>Common Log Format with Virtual Host
                           </h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>The Common log format contains only basic HTTP access information with the addition of canonical name of the Virtual Host
 serving the request.
                  </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Virtual Host</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">The canonical ServerName of the server serving the request.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Source IP</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">The client source IP address.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Remote logname</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">N/A - will contain a dash, included for compatibility.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Remote user</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">N/A - will contain a dash, included for compatibility.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Time</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Time the request was received (standard english format)</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Request</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">First line of request</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Server response code</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Web server server response code - i.e. <code class="literal">200</code></td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Response size</span></b>
                                                                    </td>
                                                                    <td align="left">Size of response in bytes, excluding HTTP headers. In CLF format, i.e. a '-' rather than a 0 when no bytes are sent.</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="sect5" title="1.2.7.2.4.&#160;NCSA extended/combined">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h4 id="NCSAextendedcombined" data-magellan-target="NCSAextendedcombined"><a name="d0e7914"></a>&#160;NCSA extended/combined
                           </h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>The NCSA extended/combined format contains the same information as the Common log format plus two additional fields: the referral
 field and the user_agent field. This log format is also called Apache Combined log format.
                  </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Source IP</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">The client source IP address.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Remote logname</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">N/A - will contain a dash, included for compatibility.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Remote user</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">N/A - will contain a dash, included for compatibility.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Time</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Time the request was received (standard english format)</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Request</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">First line of request</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Server response code</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Web server server response code - i.e. <code class="literal">200</code></td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Response size</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Size of response in bytes, excluding HTTP headers. In CLF format, i.e. a '-' rather than a 0 when no bytes are sent.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Referrer</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">The content of the request header "Referer".</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">User-Agent</span></b>
                                                                    </td>
                                                                    <td align="left">The content of the request header "User-Agent".</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="sect5" title="1.2.7.2.5.&#160;Custom format">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h4 id="Customformat" data-magellan-target="Customformat"><a name="d0e7980"></a>&#160;Custom format
                           </h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>The custom log format allows for specifying custom log formats by entering log format field names separated by space. The
 field names below are available.
                  </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="18%" align="left" />
                                                                <col width="19%" align="left" />
                                                                <col width="63%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Source IP</span></b>
                                                                    </td>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left">remote_addr</td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">The client source IP address.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Remote logname</span></b>
                                                                    </td>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left">remote_logname</td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">N/A - will contain a dash, included for compatibility.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Remote user</span></b>
                                                                    </td>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left">remote_user</td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">N/A - will contain a dash, included for compatibility.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Time</span></b>
                                                                    </td>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left">time_local</td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Time the request was received (standard english format)</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Request</span></b>
                                                                    </td>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left">request</td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">First line of request</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Server response code</span></b>
                                                                    </td>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left">status</td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Web server server response code - i.e. <code class="literal">200</code></td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Response size</span></b>
                                                                    </td>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left">body_bytes_sent</td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Size of response in bytes, excluding HTTP headers. In CLF format, i.e. a '-' rather than a 0 when no bytes are sent.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Referrer</span></b>
                                                                    </td>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left">referer</td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">The content of the request header "Referer".</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">User-Agent</span></b>
                                                                    </td>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left">user_agent</td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">The content of the request header "User-Agent".</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Cookie</span></b>
                                                                    </td>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left">cookie</td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">The content of the request header "Cookie".</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Response time</span></b>
                                                                    </td>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left">roundtrip</td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">The time taken to serve the request, in microseconds.</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">UNIX timestamp</span></b>
                                                                    </td>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left">timestamp</td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">Time the request was received (UNIX timestamp).</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Cached response</span></b>
                                                                    </td>
                                                                    <td style="border-right: 0.5pt solid;" align="left">cache</td>
                                                                    <td align="left">Is response served from cache or not (1=yes, 0=no).</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div class="sect5" title="1.2.7.2.6.&#160;Additional fields">
                                                    <div class="titlepage">
                                                        <div>
                                                            <div>
                                                                <h4 id="Additionalfields" data-magellan-target="Additionalfields"><a name="d0e8097"></a>Additional fields
                           </h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <p>If "Add roundtrip time and cache info to access log format" is enabled, the fields below will be added to the selected log
 format.
                  </p>
                                                    <div class="informaltable">
                                                        <table style="border-collapse: collapse;border-top: 0.5pt solid;border-bottom: 0.5pt solid;border-left: 0.5pt solid;border-right: 0.5pt solid;">
                                                            <colgroup>
                                                                <col width="25%" align="left" />
                                                                <col width="75%" align="left" />
                                                            </colgroup>
                                                            <tbody>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;border-bottom: 0.5pt solid;" align="left"><b><span class="guilabel">Response time</span></b>
                                                                    </td>
                                                                    <td style="border-bottom: 0.5pt solid;" align="left">The time taken to serve the request, in microseconds</td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="border-right: 0.5pt solid;" align="left"><b><span class="guilabel">Cached response</span></b>
                                                                    </td>
                                                                    <td align="left">Is response served from cache or not (1=yes, 0=no)</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            <div data-mc-conditions="Primary.beta">
                                                <h3 id="Responseinspection" data-magellan-target="Responseinspection"><a name="Response"></a>Response inspection</h3>
                                                <h4 id="Responselogging" data-magellan-target="Responselogging">Response logging</h4>
                                                <h4 id="Responseinspection1" data-magellan-target="Responseinspection1">Response inspection</h4>
                                            </div>
                                            <div class="sect3" title="1.2.8.&#160;Mirror proxy policy from master">
                                                <div class="titlepage">
                                                    <div>
                                                        <div>
                                                            <h3 id="Mirrorproxypolicyfrommaster" data-magellan-target="Mirrorproxypolicyfrommaster"><a name="mode_mirror_policy"></a>Mirror proxy policy from master
                     </h3>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p>This feature allows for configuring the proxy to dynamically mirror the policy of another website proxy.</p>
                                                <p>To mirror a proxy, select it in the drop-down list and enable the Mirror proxy policy from master module.</p>
                                                <p>When mirroring is enabled, it will be indicated in the top of the page with the text (MIRROR OF PROXY xx). Also in the websites
 overview the information in the Virtual Web server column will contain the text (M:X) where X is the website proxy ID.
            </p>
                                                <p>Note that the selected mode is not mirrored. This means that if the mirrored proxy (the master) is running in Protect mode and the mirror
 (the proxy for which mirroring is enabled) is running in Detect mode, it will log/block according to the Detect mode preset
 while the mirrored proxy will use the Protect mode preset.
</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>